{"ast":null,"code":"import _createForOfIteratorHelper from \"/root/gshark/Three.js/Gigashark-v2/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _classCallCheck from \"/root/gshark/Three.js/Gigashark-v2/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/root/gshark/Three.js/Gigashark-v2/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _assertThisInitialized from \"/root/gshark/Three.js/Gigashark-v2/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _inherits from \"/root/gshark/Three.js/Gigashark-v2/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/root/gshark/Three.js/Gigashark-v2/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport _regeneratorRuntime from \"/root/gshark/Three.js/Gigashark-v2/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/root/gshark/Three.js/Gigashark-v2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { PublicKey } from '@solana/web3.js';\nimport { createLoggerMiddleware, COMMUNICATION_JRPC_METHODS, COMMUNICATION_NOTIFICATIONS, PROVIDER_JRPC_METHODS, PROVIDER_NOTIFICATIONS } from '@toruslabs/base-controllers';\nimport { setAPIKey } from '@toruslabs/http-helpers';\nimport { SafeEventEmitter, ObjectMultiplex, createStreamMiddleware, JRPCEngine, createIdRemapMiddleware, getRpcPromiseCallback, BasePostMessageStream } from '@toruslabs/openlogin-jrpc';\nimport { ethErrors, EthereumRpcError } from 'eth-rpc-errors';\nimport { duplex } from 'is-stream';\nimport pump from 'pump';\nimport loglevel from 'loglevel';\nimport dequal from 'fast-deep-equal';\nvar messages = {\n  errors: {\n    disconnected: function disconnected() {\n      return \"Torus: Lost connection to Torus.\";\n    },\n    permanentlyDisconnected: function permanentlyDisconnected() {\n      return \"Torus: Disconnected from iframe. Page reload required.\";\n    },\n    unsupportedSync: function unsupportedSync(method) {\n      return \"Torus: The Torus Ethereum provider does not support synchronous methods like \".concat(method, \" without a callback parameter.\");\n    },\n    invalidDuplexStream: function invalidDuplexStream() {\n      return \"Must provide a Node.js-style duplex stream.\";\n    },\n    invalidOptions: function invalidOptions(maxEventListeners) {\n      return \"Invalid options. Received: { maxEventListeners: \".concat(maxEventListeners, \"}\");\n    },\n    invalidRequestArgs: function invalidRequestArgs() {\n      return \"Expected a single, non-array, object argument.\";\n    },\n    invalidRequestMethod: function invalidRequestMethod() {\n      return \"'args.method' must be a non-empty string.\";\n    },\n    invalidRequestParams: function invalidRequestParams() {\n      return \"'args.params' must be an object or array if provided.\";\n    },\n    invalidLoggerObject: function invalidLoggerObject() {\n      return \"'args.logger' must be an object if provided.\";\n    },\n    invalidLoggerMethod: function invalidLoggerMethod(method) {\n      return \"'args.logger' must include required method '\".concat(method, \"'.\");\n    }\n  },\n  info: {\n    connected: function connected(chainId) {\n      return \"Torus: Connected to chain with ID \\\"\".concat(chainId, \"\\\".\");\n    }\n  },\n  warnings: {}\n};\nvar PAYMENT_PROVIDER = {\n  MOONPAY: \"moonpay\",\n  WYRE: \"wyre\",\n  RAMPNETWORK: \"rampnetwork\",\n  XANPOOL: \"xanpool\",\n  MERCURYO: \"mercuryo\",\n  TRANSAK: \"transak\"\n};\nvar TORUS_BUILD_ENV = {\n  PRODUCTION: \"production\",\n  DEVELOPMENT: \"development\",\n  TESTING: \"testing\"\n};\nvar BUTTON_POSITION = {\n  BOTTOM_LEFT: \"bottom-left\",\n  TOP_LEFT: \"top-left\",\n  BOTTOM_RIGHT: \"bottom-right\",\n  TOP_RIGHT: \"top-right\"\n};\nvar LOGIN_PROVIDER = {\n  GOOGLE: \"google\",\n  FACEBOOK: \"facebook\",\n  REDDIT: \"reddit\",\n  DISCORD: \"discord\",\n  TWITCH: \"twitch\",\n  APPLE: \"apple\",\n  LINE: \"line\",\n  GITHUB: \"github\",\n  KAKAO: \"kakao\",\n  LINKEDIN: \"linkedin\",\n  TWITTER: \"twitter\",\n  WEIBO: \"weibo\",\n  WECHAT: \"wechat\",\n  EMAIL_PASSWORDLESS: \"email_passwordless\"\n};\nvar translations = {\n  en: {\n    embed: {\n      continue: \"Continue\",\n      actionRequired: \"Authorization required\",\n      pendingAction: \"Click continue to proceed with your request in a popup\",\n      cookiesRequired: \"Cookies Required\",\n      enableCookies: \"Please enable cookies in your browser preferences to access Torus\",\n      clickHere: \"More Info\"\n    }\n  },\n  de: {\n    embed: {\n      continue: \"Fortsetzen\",\n      actionRequired: \"Autorisierung erforderlich\",\n      pendingAction: \"Klicken Sie in einem Popup auf Weiter, um mit Ihrer Anfrage fortzufahren\",\n      cookiesRequired: \"Cookies benötigt\",\n      enableCookies: \"Bitte aktivieren Sie Cookies in Ihren Browsereinstellungen, um auf Torus zuzugreifen\",\n      clickHere: \"Mehr Info\"\n    }\n  },\n  ja: {\n    embed: {\n      continue: \"継続する\",\n      actionRequired: \"認証が必要です\",\n      pendingAction: \"続行をクリックして、ポップアップでリクエストを続行します\",\n      cookiesRequired: \"必要なクッキー\",\n      enableCookies: \"Torusにアクセスするには、ブラウザの設定でCookieを有効にしてください。\",\n      clickHere: \"詳しくは\"\n    }\n  },\n  ko: {\n    embed: {\n      continue: \"계속하다\",\n      actionRequired: \"승인 필요\",\n      pendingAction: \"팝업에서 요청을 진행하려면 계속을 클릭하십시오.\",\n      cookiesRequired: \"쿠키 필요\",\n      enableCookies: \"브라우저 환경 설정에서 쿠키를 활성화하여 Torus에 액세스하십시오.\",\n      clickHere: \"더 많은 정보\"\n    }\n  },\n  zh: {\n    embed: {\n      continue: \"继续\",\n      actionRequired: \"需要授权\",\n      pendingAction: \"单击继续以在弹出窗口中继续您的请求\",\n      cookiesRequired: \"必填Cookie\",\n      enableCookies: \"请在您的浏览器首选项中启用cookie以访问Torus。\",\n      clickHere: \"更多信息\"\n    }\n  }\n};\nvar configuration = {\n  supportedVerifierList: [LOGIN_PROVIDER.GOOGLE, LOGIN_PROVIDER.REDDIT, LOGIN_PROVIDER.DISCORD],\n  api: \"https://api.tor.us\",\n  translations: translations,\n  prodTorusUrl: \"\",\n  localStorageKey: \"torus-\".concat(window.location.hostname)\n};\nvar log = loglevel.getLogger(\"solana-embed\");\n/**\n * json-rpc-engine middleware that logs RPC errors and and validates req.method.\n *\n * @param log - The logging API to use.\n * @returns  json-rpc-engine middleware function\n */\n\nfunction createErrorMiddleware() {\n  return function (req, res, next) {\n    // json-rpc-engine will terminate the request when it notices this error\n    if (typeof req.method !== \"string\" || !req.method) {\n      res.error = ethErrors.rpc.invalidRequest({\n        message: \"The request 'method' must be a non-empty string.\",\n        data: req\n      });\n    }\n\n    next(function (done) {\n      var error = res.error;\n\n      if (!error) {\n        return done();\n      }\n\n      log.error(\"Torus - RPC Error: \".concat(error.message), error);\n      return done();\n    });\n  };\n}\n/**\n * Logs a stream disconnection error. Emits an 'error' if given an\n * EventEmitter that has listeners for the 'error' event.\n *\n * @param log - The logging API to use.\n * @param remoteLabel - The label of the disconnected stream.\n * @param error - The associated error to log.\n * @param emitter - The logging API to use.\n */\n\n\nfunction logStreamDisconnectWarning(remoteLabel, error, emitter) {\n  var warningMsg = \"Torus: Lost connection to \\\"\".concat(remoteLabel, \"\\\".\");\n\n  if (error !== null && error !== void 0 && error.stack) {\n    warningMsg += \"\\n\".concat(error.stack);\n  }\n\n  log.warn(warningMsg);\n\n  if (emitter && emitter.listenerCount(\"error\") > 0) {\n    emitter.emit(\"error\", warningMsg);\n  }\n}\n\nvar getWindowId = function getWindowId() {\n  return Math.random().toString(36).slice(2);\n};\n\nvar getTorusUrl = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(buildEnv) {\n    var torusUrl, logLevel;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.t0 = buildEnv;\n            _context.next = _context.t0 === \"testing\" ? 3 : _context.t0 === \"development\" ? 6 : 9;\n            break;\n\n          case 3:\n            torusUrl = \"https://solana-testing.tor.us\";\n            logLevel = \"debug\";\n            return _context.abrupt(\"break\", 12);\n\n          case 6:\n            torusUrl = \"http://localhost:8080\";\n            logLevel = \"debug\";\n            return _context.abrupt(\"break\", 12);\n\n          case 9:\n            torusUrl = \"https://solana.tor.us\";\n            logLevel = \"error\";\n            return _context.abrupt(\"break\", 12);\n\n          case 12:\n            return _context.abrupt(\"return\", {\n              torusUrl: torusUrl,\n              logLevel: logLevel\n            });\n\n          case 13:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function getTorusUrl(_x) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nvar getUserLanguage = function getUserLanguage() {\n  var userLanguage = window.navigator.language || \"en-US\";\n  var userLanguages = userLanguage.split(\"-\");\n  userLanguage = Object.prototype.hasOwnProperty.call(configuration.translations, userLanguages[0]) ? userLanguages[0] : \"en\";\n  return userLanguage;\n};\n\nvar FEATURES_PROVIDER_CHANGE_WINDOW = {\n  height: 660,\n  width: 375\n};\nvar FEATURES_DEFAULT_WALLET_WINDOW = {\n  height: 740,\n  width: 1315\n};\nvar FEATURES_DEFAULT_POPUP_WINDOW = {\n  height: 700,\n  width: 1200\n};\nvar FEATURES_CONFIRM_WINDOW = {\n  height: 600,\n  width: 400\n};\n\nfunction storageAvailable(type) {\n  var storage;\n\n  try {\n    storage = window[type];\n    var x = \"__storage_test__\";\n    storage.setItem(x, x);\n    storage.removeItem(x);\n    return true;\n  } catch (e) {\n    return e && ( // everything except Firefox\n    e.code === 22 || // Firefox\n    e.code === 1014 || // test name field too, because code might not be present\n    // everything except Firefox\n    e.name === \"QuotaExceededError\" || // Firefox\n    e.name === \"NS_ERROR_DOM_QUOTA_REACHED\") && // acknowledge QuotaExceededError only if there's something already stored\n    storage && storage.length !== 0;\n  }\n}\n/**\n * popup handler utils\n */\n\n\nfunction getPopupFeatures(_ref) {\n  var w = _ref.width,\n      h = _ref.height; // Fixes dual-screen position                             Most browsers      Firefox\n\n  var dualScreenLeft = window.screenLeft !== undefined ? window.screenLeft : window.screenX;\n  var dualScreenTop = window.screenTop !== undefined ? window.screenTop : window.screenY;\n  var width = window.innerWidth ? window.innerWidth : document.documentElement.clientWidth ? document.documentElement.clientWidth : window.screen.width;\n  var height = window.innerHeight ? window.innerHeight : document.documentElement.clientHeight ? document.documentElement.clientHeight : window.screen.height;\n  var systemZoom = 1; // No reliable estimate\n\n  var left = Math.abs((width - w) / 2 / systemZoom + dualScreenLeft);\n  var top = Math.abs((height - h) / 2 / systemZoom + dualScreenTop);\n  var features = \"titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=\".concat(h / systemZoom, \",width=\").concat(w / systemZoom, \",top=\").concat(top, \",left=\").concat(left);\n  return features;\n}\n\nvar BaseProvider = /*#__PURE__*/function (_SafeEventEmitter) {\n  _inherits(BaseProvider, _SafeEventEmitter);\n\n  var _super = _createSuper(BaseProvider);\n\n  /**\n   * Indicating that this provider is a Torus provider.\n   */\n  function BaseProvider(connectionStream, _ref) {\n    var _this;\n\n    _classCallCheck(this, BaseProvider);\n\n    var _ref$maxEventListener = _ref.maxEventListeners,\n        maxEventListeners = _ref$maxEventListener === void 0 ? 100 : _ref$maxEventListener,\n        _ref$jsonRpcStreamNam = _ref.jsonRpcStreamName,\n        jsonRpcStreamName = _ref$jsonRpcStreamNam === void 0 ? \"provider\" : _ref$jsonRpcStreamNam;\n    _this = _super.call(this);\n\n    _defineProperty(_assertThisInitialized(_this), \"isTorus\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"_rpcEngine\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"jsonRpcConnectionEvents\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"_state\", void 0);\n\n    if (!duplex(connectionStream)) {\n      throw new Error(messages.errors.invalidDuplexStream());\n    }\n\n    _this.isTorus = true;\n\n    _this.setMaxListeners(maxEventListeners);\n\n    _this._handleConnect = _this._handleConnect.bind(_assertThisInitialized(_this));\n    _this._handleDisconnect = _this._handleDisconnect.bind(_assertThisInitialized(_this));\n    _this._handleStreamDisconnect = _this._handleStreamDisconnect.bind(_assertThisInitialized(_this));\n    _this._rpcRequest = _this._rpcRequest.bind(_assertThisInitialized(_this));\n    _this._initializeState = _this._initializeState.bind(_assertThisInitialized(_this));\n    _this.request = _this.request.bind(_assertThisInitialized(_this));\n    _this.sendAsync = _this.sendAsync.bind(_assertThisInitialized(_this)); // this.enable = this.enable.bind(this);\n    // setup connectionStream multiplexing\n\n    var mux = new ObjectMultiplex();\n    pump(connectionStream, mux, connectionStream, _this._handleStreamDisconnect.bind(_assertThisInitialized(_this), \"Torus\")); // ignore phishing warning message (handled elsewhere)\n\n    mux.ignoreStream(\"phishing\"); // setup own event listeners\n    // connect to async provider\n\n    var jsonRpcConnection = createStreamMiddleware();\n    pump(jsonRpcConnection.stream, mux.createStream(jsonRpcStreamName), jsonRpcConnection.stream, _this._handleStreamDisconnect.bind(_assertThisInitialized(_this), \"Torus RpcProvider\")); // handle RPC requests via dapp-side rpc engine\n\n    var rpcEngine = new JRPCEngine();\n    rpcEngine.push(createIdRemapMiddleware());\n    rpcEngine.push(createErrorMiddleware());\n    rpcEngine.push(createLoggerMiddleware({\n      origin: location.origin\n    }));\n    rpcEngine.push(jsonRpcConnection.middleware);\n    _this._rpcEngine = rpcEngine;\n    _this.jsonRpcConnectionEvents = jsonRpcConnection.events;\n    return _this;\n  }\n  /**\n   * Submits an RPC request for the given method, with the given params.\n   * Resolves with the result of the method call, or rejects on error.\n   */\n\n\n  _createClass(BaseProvider, [{\n    key: \"request\",\n    value: function () {\n      var _request = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(args) {\n        var _this2 = this;\n\n        var method, params;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!(!args || typeof args !== \"object\" || Array.isArray(args))) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                throw ethErrors.rpc.invalidRequest({\n                  message: messages.errors.invalidRequestArgs(),\n                  data: args\n                });\n\n              case 2:\n                method = args.method, params = args.params;\n\n                if (!(typeof method !== \"string\" || method.length === 0)) {\n                  _context2.next = 5;\n                  break;\n                }\n\n                throw ethErrors.rpc.invalidRequest({\n                  message: messages.errors.invalidRequestMethod(),\n                  data: args\n                });\n\n              case 5:\n                if (!(params !== undefined && !Array.isArray(params) && (typeof params !== \"object\" || params === null))) {\n                  _context2.next = 7;\n                  break;\n                }\n\n                throw ethErrors.rpc.invalidRequest({\n                  message: messages.errors.invalidRequestParams(),\n                  data: args\n                });\n\n              case 7:\n                return _context2.abrupt(\"return\", new Promise(function (resolve, reject) {\n                  _this2._rpcRequest({\n                    method: method,\n                    params: params\n                  }, getRpcPromiseCallback(resolve, reject));\n                }));\n\n              case 8:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      function request(_x2) {\n        return _request.apply(this, arguments);\n      }\n\n      return request;\n    }()\n    /**\n     * Submits an RPC request per the given JSON-RPC request object.\n     */\n\n  }, {\n    key: \"send\",\n    value: function send(payload, callback) {\n      this._rpcRequest(payload, callback);\n    }\n    /**\n     * Submits an RPC request per the given JSON-RPC request object.\n     */\n\n  }, {\n    key: \"sendAsync\",\n    value: function sendAsync(payload) {\n      var _this3 = this;\n\n      return new Promise(function (resolve, reject) {\n        _this3._rpcRequest(payload, getRpcPromiseCallback(resolve, reject));\n      });\n    }\n    /**\n     * Called when connection is lost to critical streams.\n     *\n     * emits TorusInpageProvider#disconnect\n     */\n\n  }, {\n    key: \"_handleStreamDisconnect\",\n    value: function _handleStreamDisconnect(streamName, error) {\n      logStreamDisconnectWarning(streamName, error, this);\n\n      this._handleDisconnect(false, error ? error.message : undefined);\n    }\n  }]);\n\n  return BaseProvider;\n}(SafeEventEmitter);\n\nvar handleEvent = function handleEvent(handle, eventName, handler) {\n  for (var _len = arguments.length, handlerArgs = new Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {\n    handlerArgs[_key - 3] = arguments[_key];\n  }\n\n  var handlerWrapper = function handlerWrapper() {\n    handler.apply(void 0, handlerArgs);\n    handle.removeEventListener(eventName, handlerWrapper);\n  };\n\n  handle.addEventListener(eventName, handlerWrapper);\n};\n\nfunction documentReady() {\n  return _documentReady.apply(this, arguments);\n}\n\nfunction _documentReady() {\n  _documentReady = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee26() {\n    return _regeneratorRuntime().wrap(function _callee26$(_context26) {\n      while (1) {\n        switch (_context26.prev = _context26.next) {\n          case 0:\n            return _context26.abrupt(\"return\", new Promise(function (resolve) {\n              if (document.readyState !== \"loading\") {\n                resolve();\n              } else {\n                handleEvent(document, \"DOMContentLoaded\", resolve);\n              }\n            }));\n\n          case 1:\n          case \"end\":\n            return _context26.stop();\n        }\n      }\n    }, _callee26);\n  }));\n  return _documentReady.apply(this, arguments);\n}\n\nvar htmlToElement = function htmlToElement(html) {\n  var template = window.document.createElement(\"template\");\n  var trimmedHtml = html.trim(); // Never return a text node of whitespace as the result\n\n  template.innerHTML = trimmedHtml;\n  return template.content.firstChild;\n};\n\nvar PopupHandler = /*#__PURE__*/function (_SafeEventEmitter2) {\n  _inherits(PopupHandler, _SafeEventEmitter2);\n\n  var _super2 = _createSuper(PopupHandler);\n\n  function PopupHandler(_ref) {\n    var _this4;\n\n    _classCallCheck(this, PopupHandler);\n\n    var url = _ref.url,\n        target = _ref.target,\n        features = _ref.features;\n    _this4 = _super2.call(this);\n\n    _defineProperty(_assertThisInitialized(_this4), \"url\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this4), \"target\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this4), \"features\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this4), \"window\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this4), \"windowTimer\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this4), \"iClosedWindow\", void 0);\n\n    _this4.url = url;\n    _this4.target = target || \"_blank\";\n    _this4.features = features || getPopupFeatures(FEATURES_DEFAULT_POPUP_WINDOW);\n    _this4.window = undefined;\n    _this4.windowTimer = undefined;\n    _this4.iClosedWindow = false;\n\n    _this4._setupTimer();\n\n    return _this4;\n  }\n\n  _createClass(PopupHandler, [{\n    key: \"_setupTimer\",\n    value: function _setupTimer() {\n      var _this5 = this;\n\n      this.windowTimer = Number(setInterval(function () {\n        if (_this5.window && _this5.window.closed) {\n          clearInterval(_this5.windowTimer);\n\n          if (!_this5.iClosedWindow) {\n            _this5.emit(\"close\");\n          }\n\n          _this5.iClosedWindow = false;\n          _this5.window = undefined;\n        }\n\n        if (_this5.window === undefined) clearInterval(_this5.windowTimer);\n      }, 500));\n    }\n  }, {\n    key: \"open\",\n    value: function open() {\n      var _this$window;\n\n      this.window = window.open(this.url.href, this.target, this.features);\n      if ((_this$window = this.window) !== null && _this$window !== void 0 && _this$window.focus) this.window.focus();\n      return Promise.resolve();\n    }\n  }, {\n    key: \"close\",\n    value: function close() {\n      this.iClosedWindow = true;\n      if (this.window) this.window.close();\n    }\n  }, {\n    key: \"redirect\",\n    value: function redirect(locationReplaceOnRedirect) {\n      if (locationReplaceOnRedirect) {\n        window.location.replace(this.url.href);\n      } else {\n        window.location.href = this.url.href;\n      }\n    }\n  }]);\n\n  return PopupHandler;\n}(SafeEventEmitter);\n\nfunction ownKeys$2(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread$2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys$2(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys$2(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n\nvar TorusCommunicationProvider = /*#__PURE__*/function (_BaseProvider) {\n  _inherits(TorusCommunicationProvider, _BaseProvider);\n\n  var _super3 = _createSuper(TorusCommunicationProvider);\n\n  function TorusCommunicationProvider(connectionStream, _ref) {\n    var _this6;\n\n    _classCallCheck(this, TorusCommunicationProvider);\n\n    var _ref$maxEventListener2 = _ref.maxEventListeners,\n        maxEventListeners = _ref$maxEventListener2 === void 0 ? 100 : _ref$maxEventListener2,\n        _ref$jsonRpcStreamNam2 = _ref.jsonRpcStreamName,\n        jsonRpcStreamName = _ref$jsonRpcStreamNam2 === void 0 ? \"provider\" : _ref$jsonRpcStreamNam2;\n    _this6 = _super3.call(this, connectionStream, {\n      maxEventListeners: maxEventListeners,\n      jsonRpcStreamName: jsonRpcStreamName\n    }); // private state\n\n    _defineProperty(_assertThisInitialized(_this6), \"embedTranslations\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this6), \"torusUrl\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this6), \"dappStorageKey\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this6), \"windowRefs\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this6), \"tryWindowHandle\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this6), \"torusAlertContainer\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this6), \"torusIframe\", void 0);\n\n    _this6._state = _objectSpread$2({}, TorusCommunicationProvider._defaultState); // public state\n\n    _this6.torusUrl = \"\";\n    _this6.dappStorageKey = \"\";\n    var languageTranslations = configuration.translations[getUserLanguage()];\n    _this6.embedTranslations = languageTranslations.embed;\n    _this6.windowRefs = {}; // setup own event listeners\n    // EIP-1193 connect\n\n    _this6.on(\"connect\", function () {\n      _this6._state.isConnected = true;\n    });\n\n    var notificationHandler = function notificationHandler(payload) {\n      var method = payload.method,\n          params = payload.params;\n\n      if (method === COMMUNICATION_NOTIFICATIONS.IFRAME_STATUS) {\n        var isFullScreen = params.isFullScreen,\n            rid = params.rid;\n\n        _this6._displayIframe({\n          isFull: isFullScreen,\n          rid: rid\n        });\n      } else if (method === COMMUNICATION_NOTIFICATIONS.CREATE_WINDOW) {\n        var windowId = params.windowId,\n            url = params.url;\n\n        _this6._createPopupBlockAlert(windowId, url);\n      } else if (method === COMMUNICATION_NOTIFICATIONS.CLOSE_WINDOW) {\n        _this6._handleCloseWindow(params);\n      } else if (method === COMMUNICATION_NOTIFICATIONS.USER_LOGGED_IN) {\n        var currentLoginProvider = params.currentLoginProvider;\n        _this6._state.isLoggedIn = true;\n        _this6._state.currentLoginProvider = currentLoginProvider;\n      } else if (method === COMMUNICATION_NOTIFICATIONS.USER_LOGGED_OUT) {\n        _this6._state.isLoggedIn = false;\n        _this6._state.currentLoginProvider = null;\n\n        _this6._displayIframe();\n      }\n    };\n\n    _this6.jsonRpcConnectionEvents.on(\"notification\", notificationHandler);\n\n    return _this6;\n  }\n\n  _createClass(TorusCommunicationProvider, [{\n    key: \"isLoggedIn\",\n    get: function get() {\n      return this._state.isLoggedIn;\n    }\n  }, {\n    key: \"isIFrameFullScreen\",\n    get: function get() {\n      return this._state.isIFrameFullScreen;\n    }\n    /**\n     * Returns whether the inPage provider is connected to Torus.\n     */\n\n  }, {\n    key: \"isConnected\",\n    value: function isConnected() {\n      return this._state.isConnected;\n    }\n  }, {\n    key: \"_initializeState\",\n    value: function () {\n      var _initializeState2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(params) {\n        var _this7 = this;\n\n        var torusUrl, dappStorageKey, torusAlertContainer, torusIframe, _yield$this$request, currentLoginProvider, isLoggedIn;\n\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.prev = 0;\n                torusUrl = params.torusUrl, dappStorageKey = params.dappStorageKey, torusAlertContainer = params.torusAlertContainer, torusIframe = params.torusIframe;\n                this.torusUrl = torusUrl;\n                this.dappStorageKey = dappStorageKey;\n                this.torusAlertContainer = torusAlertContainer;\n                this.torusIframe = torusIframe;\n                this.torusIframe.addEventListener(\"load\", function () {\n                  // only do this if iframe is not full screen\n                  if (!_this7._state.isIFrameFullScreen) _this7._displayIframe();\n                });\n                _context3.next = 9;\n                return this.request({\n                  method: COMMUNICATION_JRPC_METHODS.GET_PROVIDER_STATE,\n                  params: []\n                });\n\n              case 9:\n                _yield$this$request = _context3.sent;\n                currentLoginProvider = _yield$this$request.currentLoginProvider;\n                isLoggedIn = _yield$this$request.isLoggedIn;\n\n                // indicate that we've connected, for EIP-1193 compliance\n                this._handleConnect(currentLoginProvider, isLoggedIn);\n\n                _context3.next = 18;\n                break;\n\n              case 15:\n                _context3.prev = 15;\n                _context3.t0 = _context3[\"catch\"](0);\n                log.error(\"Torus: Failed to get initial state. Please report this bug.\", _context3.t0);\n\n              case 18:\n                _context3.prev = 18;\n                log.info(\"initialized communication state\");\n                this._state.initialized = true;\n                this.emit(\"_initialized\");\n                return _context3.finish(18);\n\n              case 23:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[0, 15, 18, 23]]);\n      }));\n\n      function _initializeState(_x3) {\n        return _initializeState2.apply(this, arguments);\n      }\n\n      return _initializeState;\n    }()\n  }, {\n    key: \"_handleWindow\",\n    value: function _handleWindow(windowId) {\n      var _this8 = this;\n\n      var _ref3 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n          url = _ref3.url,\n          target = _ref3.target,\n          features = _ref3.features;\n\n      var finalUrl = new URL(url || \"\".concat(this.torusUrl, \"/redirect?windowId=\").concat(windowId));\n\n      if (this.dappStorageKey) {\n        // If multiple instances, it returns the first one\n        if (finalUrl.hash) finalUrl.hash += \"&dappStorageKey=\".concat(this.dappStorageKey);else finalUrl.hash = \"#dappStorageKey=\".concat(this.dappStorageKey);\n      }\n\n      var handledWindow = new PopupHandler({\n        url: finalUrl,\n        target: target,\n        features: features\n      });\n      handledWindow.open();\n\n      if (!handledWindow.window) {\n        this._createPopupBlockAlert(windowId, finalUrl.href);\n\n        return;\n      } // Add to collection only if window is opened\n\n\n      this.windowRefs[windowId] = handledWindow; // We tell the iframe that the window has been successfully opened\n\n      this.request({\n        method: COMMUNICATION_JRPC_METHODS.OPENED_WINDOW,\n        params: {\n          windowId: windowId\n        }\n      });\n      handledWindow.once(\"close\", function () {\n        // user closed the window\n        delete _this8.windowRefs[windowId];\n\n        _this8.request({\n          method: COMMUNICATION_JRPC_METHODS.CLOSED_WINDOW,\n          params: {\n            windowId: windowId\n          }\n        });\n      });\n    }\n  }, {\n    key: \"_displayIframe\",\n    value: function _displayIframe() {\n      var _ref4 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          _ref4$isFull = _ref4.isFull,\n          isFull = _ref4$isFull === void 0 ? false : _ref4$isFull,\n          _ref4$rid = _ref4.rid,\n          rid = _ref4$rid === void 0 ? \"\" : _ref4$rid;\n\n      var style = {}; // set phase\n\n      if (!isFull) {\n        style.display = this._state.torusWidgetVisibility ? \"block\" : \"none\";\n        style.height = \"70px\";\n        style.width = \"70px\";\n\n        switch (this._state.buttonPosition) {\n          case BUTTON_POSITION.TOP_LEFT:\n            style.top = \"0px\";\n            style.left = \"0px\";\n            style.right = \"auto\";\n            style.bottom = \"auto\";\n            break;\n\n          case BUTTON_POSITION.TOP_RIGHT:\n            style.top = \"0px\";\n            style.right = \"0px\";\n            style.left = \"auto\";\n            style.bottom = \"auto\";\n            break;\n\n          case BUTTON_POSITION.BOTTOM_RIGHT:\n            style.bottom = \"0px\";\n            style.right = \"0px\";\n            style.top = \"auto\";\n            style.left = \"auto\";\n            break;\n\n          case BUTTON_POSITION.BOTTOM_LEFT:\n          default:\n            style.bottom = \"0px\";\n            style.left = \"0px\";\n            style.top = \"auto\";\n            style.right = \"auto\";\n            break;\n        }\n      } else {\n        style.display = \"block\";\n        style.width = \"100%\";\n        style.height = \"100%\";\n        style.top = \"0px\";\n        style.right = \"0px\";\n        style.left = \"0px\";\n        style.bottom = \"0px\";\n      }\n\n      Object.assign(this.torusIframe.style, style);\n      this._state.isIFrameFullScreen = isFull;\n      this.request({\n        method: COMMUNICATION_JRPC_METHODS.IFRAME_STATUS,\n        params: {\n          isIFrameFullScreen: isFull,\n          rid: rid\n        }\n      });\n    }\n  }, {\n    key: \"hideTorusButton\",\n    value: function hideTorusButton() {\n      this._state.torusWidgetVisibility = false;\n\n      this._displayIframe();\n    }\n  }, {\n    key: \"showTorusButton\",\n    value: function showTorusButton() {\n      this._state.torusWidgetVisibility = true;\n\n      this._displayIframe();\n    }\n    /**\n     * Internal RPC method. Forwards requests to background via the RPC engine.\n     * Also remap ids inbound and outbound\n     */\n\n  }, {\n    key: \"_rpcRequest\",\n    value: function _rpcRequest(payload, callback) {\n      var cb = callback;\n      var _payload = payload;\n\n      if (!Array.isArray(_payload)) {\n        if (!_payload.jsonrpc) {\n          _payload.jsonrpc = \"2.0\";\n        }\n      }\n\n      this.tryWindowHandle(_payload, cb);\n    }\n    /**\n     * When the provider becomes connected, updates internal state and emits\n     * required events. Idempotent.\n     *\n     * @param currentLoginProvider - The login Provider\n     * emits TorusInpageProvider#connect\n     */\n\n  }, {\n    key: \"_handleConnect\",\n    value: function _handleConnect(currentLoginProvider, isLoggedIn) {\n      if (!this._state.isConnected) {\n        this._state.isConnected = true;\n        this.emit(\"connect\", {\n          currentLoginProvider: currentLoginProvider,\n          isLoggedIn: isLoggedIn\n        });\n        log.debug(messages.info.connected(currentLoginProvider));\n      }\n    }\n    /**\n     * When the provider becomes disconnected, updates internal state and emits\n     * required events. Idempotent with respect to the isRecoverable parameter.\n     *\n     * Error codes per the CloseEvent status codes as required by EIP-1193:\n     * https://developer.mozilla.org/en-US/docs/Web/API/CloseEvent#Status_codes\n     *\n     * @param isRecoverable - Whether the disconnection is recoverable.\n     * @param errorMessage - A custom error message.\n     * emits TorusInpageProvider#disconnect\n     */\n\n  }, {\n    key: \"_handleDisconnect\",\n    value: function _handleDisconnect(isRecoverable, errorMessage) {\n      if (this._state.isConnected || !this._state.isPermanentlyDisconnected && !isRecoverable) {\n        this._state.isConnected = false;\n        var error;\n\n        if (isRecoverable) {\n          error = new EthereumRpcError(1013, // Try again later\n          errorMessage || messages.errors.disconnected());\n          log.debug(error);\n        } else {\n          error = new EthereumRpcError(1011, // Internal error\n          errorMessage || messages.errors.permanentlyDisconnected());\n          log.error(error);\n          this._state.currentLoginProvider = null;\n          this._state.isLoggedIn = false;\n          this._state.torusWidgetVisibility = false;\n          this._state.isIFrameFullScreen = false;\n          this._state.isPermanentlyDisconnected = true;\n        }\n\n        this.emit(\"disconnect\", error);\n      }\n    } // Called if the iframe wants to close the window cause it is done processing the request\n\n  }, {\n    key: \"_handleCloseWindow\",\n    value: function _handleCloseWindow(params) {\n      var windowId = params.windowId;\n\n      if (this.windowRefs[windowId]) {\n        this.windowRefs[windowId].close();\n        delete this.windowRefs[windowId];\n      }\n    }\n  }, {\n    key: \"_createPopupBlockAlert\",\n    value: function () {\n      var _createPopupBlockAlert2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(windowId, url) {\n        var _this9 = this;\n\n        var logoUrl, torusAlert, successAlert, btnContainer, bindOnLoad, attachOnLoad;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                logoUrl = this.getLogoUrl();\n                torusAlert = htmlToElement('<div id=\"torusAlert\" class=\"torus-alert--v2\">' + \"<div id=\\\"torusAlert__logo\\\"><img src=\\\"\".concat(logoUrl, \"\\\" /></div>\") + \"<div>\" + \"<h1 id=\\\"torusAlert__title\\\">\".concat(this.embedTranslations.actionRequired, \"</h1>\") + \"<p id=\\\"torusAlert__desc\\\">\".concat(this.embedTranslations.pendingAction, \"</p>\") + \"</div>\" + \"</div>\");\n                successAlert = htmlToElement(\"<div><a id=\\\"torusAlert__btn\\\">\".concat(this.embedTranslations.continue, \"</a></div>\"));\n                btnContainer = htmlToElement('<div id=\"torusAlert__btn-container\"></div>');\n                btnContainer.appendChild(successAlert);\n                torusAlert.appendChild(btnContainer);\n\n                bindOnLoad = function bindOnLoad() {\n                  successAlert.addEventListener(\"click\", function () {\n                    _this9._handleWindow(windowId, {\n                      url: url,\n                      target: \"_blank\",\n                      features: getPopupFeatures(FEATURES_CONFIRM_WINDOW)\n                    });\n\n                    torusAlert.remove();\n                    if (_this9.torusAlertContainer.children.length === 0) _this9.torusAlertContainer.style.display = \"none\";\n                  });\n                };\n\n                attachOnLoad = function attachOnLoad() {\n                  _this9.torusAlertContainer.appendChild(torusAlert);\n                };\n\n                _context4.next = 10;\n                return documentReady();\n\n              case 10:\n                attachOnLoad();\n                bindOnLoad();\n                this.torusAlertContainer.style.display = \"block\";\n\n              case 13:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function _createPopupBlockAlert(_x4, _x5) {\n        return _createPopupBlockAlert2.apply(this, arguments);\n      }\n\n      return _createPopupBlockAlert;\n    }()\n  }, {\n    key: \"getLogoUrl\",\n    value: function getLogoUrl() {\n      var logoUrl = \"\".concat(this.torusUrl, \"/images/torus_icon-blue.svg\");\n      return logoUrl;\n    }\n  }]);\n\n  return TorusCommunicationProvider;\n}(BaseProvider);\n\n_defineProperty(TorusCommunicationProvider, \"_defaultState\", {\n  buttonPosition: \"bottom-left\",\n  currentLoginProvider: null,\n  isIFrameFullScreen: false,\n  hasEmittedConnection: false,\n  torusWidgetVisibility: false,\n  initialized: false,\n  isLoggedIn: false,\n  isPermanentlyDisconnected: false,\n  isConnected: false\n});\n\nfunction ownKeys$1(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread$1(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys$1(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys$1(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n\nvar TorusInPageProvider = /*#__PURE__*/function (_BaseProvider2) {\n  _inherits(TorusInPageProvider, _BaseProvider2);\n\n  var _super4 = _createSuper(TorusInPageProvider);\n\n  /**\n   * The chain ID of the currently connected Solana chain.\n   * See [chainId.network]{@link https://chainid.network} for more information.\n   */\n\n  /**\n   * The user's currently selected Solana address.\n   * If null, Torus is either locked or the user has not permitted any\n   * addresses to be viewed.\n   */\n  function TorusInPageProvider(connectionStream, _ref) {\n    var _this10;\n\n    _classCallCheck(this, TorusInPageProvider);\n\n    var _ref$maxEventListener3 = _ref.maxEventListeners,\n        maxEventListeners = _ref$maxEventListener3 === void 0 ? 100 : _ref$maxEventListener3,\n        _ref$jsonRpcStreamNam3 = _ref.jsonRpcStreamName,\n        jsonRpcStreamName = _ref$jsonRpcStreamNam3 === void 0 ? \"provider\" : _ref$jsonRpcStreamNam3;\n    _this10 = _super4.call(this, connectionStream, {\n      maxEventListeners: maxEventListeners,\n      jsonRpcStreamName: jsonRpcStreamName\n    }); // private state\n\n    _defineProperty(_assertThisInitialized(_this10), \"chainId\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this10), \"selectedAddress\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this10), \"tryWindowHandle\", void 0);\n\n    _this10._state = _objectSpread$1({}, TorusInPageProvider._defaultState); // public state\n\n    _this10.selectedAddress = null;\n    _this10.chainId = null;\n    _this10._handleAccountsChanged = _this10._handleAccountsChanged.bind(_assertThisInitialized(_this10));\n    _this10._handleChainChanged = _this10._handleChainChanged.bind(_assertThisInitialized(_this10));\n    _this10._handleUnlockStateChanged = _this10._handleUnlockStateChanged.bind(_assertThisInitialized(_this10)); // setup own event listeners\n    // EIP-1193 connect\n\n    _this10.on(\"connect\", function () {\n      _this10._state.isConnected = true;\n    });\n\n    var jsonRpcNotificationHandler = function jsonRpcNotificationHandler(payload) {\n      var method = payload.method,\n          params = payload.params;\n\n      if (method === PROVIDER_NOTIFICATIONS.ACCOUNTS_CHANGED) {\n        _this10._handleAccountsChanged(params);\n      } else if (method === PROVIDER_NOTIFICATIONS.UNLOCK_STATE_CHANGED) {\n        _this10._handleUnlockStateChanged(params);\n      } else if (method === PROVIDER_NOTIFICATIONS.CHAIN_CHANGED) {\n        _this10._handleChainChanged(params);\n      }\n    }; // json rpc notification listener\n\n\n    _this10.jsonRpcConnectionEvents.on(\"notification\", jsonRpcNotificationHandler);\n\n    return _this10;\n  }\n  /**\n   * Returns whether the inpage provider is connected to Torus.\n   */\n\n\n  _createClass(TorusInPageProvider, [{\n    key: \"isConnected\",\n    value: function isConnected() {\n      return this._state.isConnected;\n    } // Private Methods\n    //= ===================\n\n    /**\n     * Constructor helper.\n     * Populates initial state by calling 'wallet_getProviderState' and emits\n     * necessary events.\n     */\n\n  }, {\n    key: \"_initializeState\",\n    value: function () {\n      var _initializeState3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n        var _yield$this$request2, accounts, chainId, isUnlocked;\n\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.prev = 0;\n                _context5.next = 3;\n                return this.request({\n                  method: PROVIDER_JRPC_METHODS.GET_PROVIDER_STATE,\n                  params: []\n                });\n\n              case 3:\n                _yield$this$request2 = _context5.sent;\n                accounts = _yield$this$request2.accounts;\n                chainId = _yield$this$request2.chainId;\n                isUnlocked = _yield$this$request2.isUnlocked;\n                // indicate that we've connected, for EIP-1193 compliance\n                this.emit(\"connect\", {\n                  chainId: chainId\n                });\n\n                this._handleChainChanged({\n                  chainId: chainId\n                });\n\n                this._handleUnlockStateChanged({\n                  accounts: accounts,\n                  isUnlocked: isUnlocked\n                });\n\n                this._handleAccountsChanged(accounts);\n\n                _context5.next = 16;\n                break;\n\n              case 13:\n                _context5.prev = 13;\n                _context5.t0 = _context5[\"catch\"](0);\n                log.error(\"Torus: Failed to get initial state. Please report this bug.\", _context5.t0);\n\n              case 16:\n                _context5.prev = 16;\n                log.info(\"initialized provider state\");\n                this._state.initialized = true;\n                this.emit(\"_initialized\");\n                return _context5.finish(16);\n\n              case 21:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this, [[0, 13, 16, 21]]);\n      }));\n\n      function _initializeState() {\n        return _initializeState3.apply(this, arguments);\n      }\n\n      return _initializeState;\n    }()\n    /**\n     * Internal RPC method. Forwards requests to background via the RPC engine.\n     * Also remap ids inbound and outbound\n     */\n\n  }, {\n    key: \"_rpcRequest\",\n    value: function _rpcRequest(payload, callback) {\n      var _this11 = this;\n\n      var isInternal = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var cb = callback;\n      var _payload = payload;\n\n      if (!Array.isArray(_payload)) {\n        if (!_payload.jsonrpc) {\n          _payload.jsonrpc = \"2.0\";\n        }\n\n        if (_payload.method === \"solana_accounts\" || _payload.method === \"solana_requestAccounts\") {\n          // handle accounts changing\n          cb = function cb(err, res) {\n            _this11._handleAccountsChanged(res.result || [], _payload.method === \"solana_accounts\", isInternal);\n\n            callback(err, res);\n          };\n        } else if (_payload.method === \"wallet_getProviderState\") {\n          this._rpcEngine.handle(payload, cb);\n\n          return;\n        }\n      }\n\n      this.tryWindowHandle(_payload, cb);\n    }\n    /**\n     * When the provider becomes connected, updates internal state and emits\n     * required events. Idempotent.\n     *\n     * @param chainId - The ID of the newly connected chain.\n     * emits TorusInpageProvider#connect\n     */\n\n  }, {\n    key: \"_handleConnect\",\n    value: function _handleConnect(chainId) {\n      if (!this._state.isConnected) {\n        this._state.isConnected = true;\n        this.emit(\"connect\", {\n          chainId: chainId\n        });\n        log.debug(messages.info.connected(chainId));\n      }\n    }\n    /**\n     * When the provider becomes disconnected, updates internal state and emits\n     * required events. Idempotent with respect to the isRecoverable parameter.\n     *\n     * Error codes per the CloseEvent status codes as required by EIP-1193:\n     * https://developer.mozilla.org/en-US/docs/Web/API/CloseEvent#Status_codes\n     *\n     * @param isRecoverable - Whether the disconnection is recoverable.\n     * @param errorMessage - A custom error message.\n     * emits TorusInpageProvider#disconnect\n     */\n\n  }, {\n    key: \"_handleDisconnect\",\n    value: function _handleDisconnect(isRecoverable, errorMessage) {\n      if (this._state.isConnected || !this._state.isPermanentlyDisconnected && !isRecoverable) {\n        this._state.isConnected = false;\n        var error;\n\n        if (isRecoverable) {\n          error = new EthereumRpcError(1013, // Try again later\n          errorMessage || messages.errors.disconnected());\n          log.debug(error);\n        } else {\n          error = new EthereumRpcError(1011, // Internal error\n          errorMessage || messages.errors.permanentlyDisconnected());\n          log.error(error);\n          this.chainId = null;\n          this._state.accounts = null;\n          this.selectedAddress = null;\n          this._state.isUnlocked = false;\n          this._state.isPermanentlyDisconnected = true;\n        }\n\n        this.emit(\"disconnect\", error);\n      }\n    }\n    /**\n     * Called when accounts may have changed.\n     */\n\n  }, {\n    key: \"_handleAccountsChanged\",\n    value: function _handleAccountsChanged(accounts) {\n      var isEthAccounts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var isInternal = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false; // defensive programming\n\n      var finalAccounts = accounts;\n\n      if (!Array.isArray(finalAccounts)) {\n        log.error(\"Torus: Received non-array accounts parameter. Please report this bug.\", finalAccounts);\n        finalAccounts = [];\n      }\n\n      var _iterator = _createForOfIteratorHelper(accounts),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var account = _step.value;\n\n          if (typeof account !== \"string\") {\n            log.error(\"Torus: Received non-string account. Please report this bug.\", accounts);\n            finalAccounts = [];\n            break;\n          }\n        } // emit accountsChanged if anything about the accounts array has changed\n\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      if (!dequal(this._state.accounts, finalAccounts)) {\n        // we should always have the correct accounts even before solana_accounts\n        // returns, except in cases where isInternal is true\n        if (isEthAccounts && Array.isArray(this._state.accounts) && this._state.accounts.length > 0 && !isInternal) {\n          log.error('Torus: \"solana_accounts\" unexpectedly updated accounts. Please report this bug.', finalAccounts);\n        }\n\n        this._state.accounts = finalAccounts;\n        this.emit(\"accountsChanged\", finalAccounts);\n      } // handle selectedAddress\n\n\n      if (this.selectedAddress !== finalAccounts[0]) {\n        this.selectedAddress = finalAccounts[0] || null;\n      }\n    }\n    /**\n     * Upon receipt of a new chainId and networkVersion, emits corresponding\n     * events and sets relevant public state.\n     * Does nothing if neither the chainId nor the networkVersion are different\n     * from existing values.\n     *\n     * emits TorusInpageProvider#chainChanged\n     * @param networkInfo - An object with network info.\n     */\n\n  }, {\n    key: \"_handleChainChanged\",\n    value: function _handleChainChanged() {\n      var _ref5 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          chainId = _ref5.chainId;\n\n      if (!chainId) {\n        log.error(\"Torus: Received invalid network parameters. Please report this bug.\", {\n          chainId: chainId\n        });\n        return;\n      }\n\n      if (chainId === \"loading\") {\n        this._handleDisconnect(true);\n      } else {\n        this._handleConnect(chainId);\n\n        if (chainId !== this.chainId) {\n          this.chainId = chainId;\n\n          if (this._state.initialized) {\n            this.emit(\"chainChanged\", this.chainId);\n          }\n        }\n      }\n    }\n    /**\n     * Upon receipt of a new isUnlocked state, sets relevant public state.\n     * Calls the accounts changed handler with the received accounts, or an empty\n     * array.\n     *\n     * Does nothing if the received value is equal to the existing value.\n     * There are no lock/unlock events.\n     *\n     * @param opts - Options bag.\n     */\n\n  }, {\n    key: \"_handleUnlockStateChanged\",\n    value: function _handleUnlockStateChanged() {\n      var _ref6 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          accounts = _ref6.accounts,\n          isUnlocked = _ref6.isUnlocked;\n\n      if (typeof isUnlocked !== \"boolean\") {\n        log.error(\"Torus: Received invalid isUnlocked parameter. Please report this bug.\", {\n          isUnlocked: isUnlocked\n        });\n        return;\n      }\n\n      if (isUnlocked !== this._state.isUnlocked) {\n        this._state.isUnlocked = isUnlocked;\n\n        this._handleAccountsChanged(accounts || []);\n      }\n    }\n  }]);\n\n  return TorusInPageProvider;\n}(BaseProvider);\n\n_defineProperty(TorusInPageProvider, \"_defaultState\", {\n  accounts: null,\n  isConnected: false,\n  isUnlocked: false,\n  initialized: false,\n  isPermanentlyDisconnected: false,\n  hasEmittedConnection: false\n});\n/**\n * Returns whether the given image URL exists\n */\n\n\nfunction imgExists(url) {\n  return new Promise(function (resolve, reject) {\n    try {\n      var img = document.createElement(\"img\");\n\n      img.onload = function () {\n        return resolve(true);\n      };\n\n      img.onerror = function () {\n        return resolve(false);\n      };\n\n      img.src = url;\n    } catch (e) {\n      reject(e);\n    }\n  });\n}\n/**\n * Extracts a name for the site from the DOM\n */\n\n\nvar getSiteName = function getSiteName(window) {\n  var document = window.document;\n  var siteName = document.querySelector('head > meta[property=\"og:site_name\"]');\n\n  if (siteName) {\n    return siteName.content;\n  }\n\n  var metaTitle = document.querySelector('head > meta[name=\"title\"]');\n\n  if (metaTitle) {\n    return metaTitle.content;\n  }\n\n  if (document.title && document.title.length > 0) {\n    return document.title;\n  }\n\n  return window.location.hostname;\n};\n/**\n * Extracts an icon for the site from the DOM\n */\n\n\nfunction getSiteIcon(_x6) {\n  return _getSiteIcon.apply(this, arguments);\n}\n/**\n * Gets site metadata and returns it\n *\n */\n\n\nfunction _getSiteIcon() {\n  _getSiteIcon = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee27(window) {\n    var _document, icon;\n\n    return _regeneratorRuntime().wrap(function _callee27$(_context27) {\n      while (1) {\n        switch (_context27.prev = _context27.next) {\n          case 0:\n            _context27.prev = 0;\n            _document = window.document; // Use the site's favicon if it exists\n\n            icon = _document.querySelector('head > link[rel=\"shortcut icon\"]');\n            _context27.t0 = icon;\n\n            if (!_context27.t0) {\n              _context27.next = 8;\n              break;\n            }\n\n            _context27.next = 7;\n            return imgExists(icon.href);\n\n          case 7:\n            _context27.t0 = _context27.sent;\n\n          case 8:\n            if (!_context27.t0) {\n              _context27.next = 10;\n              break;\n            }\n\n            return _context27.abrupt(\"return\", icon.href);\n\n          case 10:\n            // Search through available icons in no particular order\n            icon = Array.from(_document.querySelectorAll('head > link[rel=\"icon\"]')).find(function (_icon) {\n              return Boolean(_icon.href);\n            });\n            _context27.t1 = icon;\n\n            if (!_context27.t1) {\n              _context27.next = 16;\n              break;\n            }\n\n            _context27.next = 15;\n            return imgExists(icon.href);\n\n          case 15:\n            _context27.t1 = _context27.sent;\n\n          case 16:\n            if (!_context27.t1) {\n              _context27.next = 18;\n              break;\n            }\n\n            return _context27.abrupt(\"return\", icon.href);\n\n          case 18:\n            return _context27.abrupt(\"return\", \"\");\n\n          case 21:\n            _context27.prev = 21;\n            _context27.t2 = _context27[\"catch\"](0);\n            return _context27.abrupt(\"return\", \"\");\n\n          case 24:\n          case \"end\":\n            return _context27.stop();\n        }\n      }\n    }, _callee27, null, [[0, 21]]);\n  }));\n  return _getSiteIcon.apply(this, arguments);\n}\n\nvar getSiteMetadata = /*#__PURE__*/function () {\n  var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n    return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            _context6.t0 = getSiteName(window);\n            _context6.next = 3;\n            return getSiteIcon(window);\n\n          case 3:\n            _context6.t1 = _context6.sent;\n            return _context6.abrupt(\"return\", {\n              name: _context6.t0,\n              icon: _context6.t1\n            });\n\n          case 5:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, _callee6);\n  }));\n\n  return function getSiteMetadata() {\n    return _ref7.apply(this, arguments);\n  };\n}();\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n\nvar _require = require(\"../package.json\"),\n    version = _require.version;\n\nvar PROVIDER_UNSAFE_METHODS = [\"send_transaction\", \"sign_transaction\", \"sign_all_transactions\", \"sign_message\", \"connect\"];\nvar COMMUNICATION_UNSAFE_METHODS = [COMMUNICATION_JRPC_METHODS.SET_PROVIDER];\nvar isLocalStorageAvailable = storageAvailable(\"localStorage\"); // preload for iframe doesn't work https://bugs.chromium.org/p/chromium/issues/detail?id=593267\n\n(function () {\n  var _preLoadIframe = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7() {\n    var torusIframeHtml, _yield$getTorusUrl, torusUrl;\n\n    return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n      while (1) {\n        switch (_context7.prev = _context7.next) {\n          case 0:\n            _context7.prev = 0;\n\n            if (!(typeof document === \"undefined\")) {\n              _context7.next = 3;\n              break;\n            }\n\n            return _context7.abrupt(\"return\");\n\n          case 3:\n            torusIframeHtml = document.createElement(\"link\");\n            _context7.next = 6;\n            return getTorusUrl(\"production\");\n\n          case 6:\n            _yield$getTorusUrl = _context7.sent;\n            torusUrl = _yield$getTorusUrl.torusUrl;\n            torusIframeHtml.href = \"\".concat(torusUrl, \"/frame\");\n            torusIframeHtml.crossOrigin = \"anonymous\";\n            torusIframeHtml.type = \"text/html\";\n            torusIframeHtml.rel = \"prefetch\";\n\n            if (torusIframeHtml.relList && torusIframeHtml.relList.supports) {\n              if (torusIframeHtml.relList.supports(\"prefetch\")) {\n                document.head.appendChild(torusIframeHtml);\n              }\n            }\n\n            _context7.next = 18;\n            break;\n\n          case 15:\n            _context7.prev = 15;\n            _context7.t0 = _context7[\"catch\"](0);\n            log.warn(_context7.t0);\n\n          case 18:\n          case \"end\":\n            return _context7.stop();\n        }\n      }\n    }, _callee7, null, [[0, 15]]);\n  }));\n\n  function preLoadIframe() {\n    return _preLoadIframe.apply(this, arguments);\n  }\n\n  return preLoadIframe;\n})()();\n\nvar Torus = /*#__PURE__*/function () {\n  function Torus() {\n    _classCallCheck(this, Torus);\n\n    var _ref8 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        _ref8$modalZIndex = _ref8.modalZIndex,\n        modalZIndex = _ref8$modalZIndex === void 0 ? 99999 : _ref8$modalZIndex;\n\n    _defineProperty(this, \"isInitialized\", void 0);\n\n    _defineProperty(this, \"torusAlert\", void 0);\n\n    _defineProperty(this, \"modalZIndex\", void 0);\n\n    _defineProperty(this, \"alertZIndex\", void 0);\n\n    _defineProperty(this, \"requestedLoginProvider\", void 0);\n\n    _defineProperty(this, \"provider\", void 0);\n\n    _defineProperty(this, \"communicationProvider\", void 0);\n\n    _defineProperty(this, \"dappStorageKey\", void 0);\n\n    _defineProperty(this, \"torusAlertContainer\", void 0);\n\n    _defineProperty(this, \"torusUrl\", void 0);\n\n    _defineProperty(this, \"torusIframe\", void 0);\n\n    _defineProperty(this, \"styleLink\", void 0);\n\n    this.torusUrl = \"\";\n    this.isInitialized = false; // init done\n\n    this.requestedLoginProvider = null;\n    this.modalZIndex = modalZIndex;\n    this.alertZIndex = modalZIndex + 1000;\n    this.dappStorageKey = \"\";\n  }\n\n  _createClass(Torus, [{\n    key: \"isLoggedIn\",\n    get: function get() {\n      if (!this.communicationProvider) return false;\n      return this.communicationProvider.isLoggedIn;\n    }\n  }, {\n    key: \"init\",\n    value: function () {\n      var _init = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee10() {\n        var _this12 = this;\n\n        var _ref9,\n            _ref9$buildEnv,\n            buildEnv,\n            _ref9$enableLogging,\n            enableLogging,\n            network,\n            _ref9$showTorusButton,\n            showTorusButton,\n            _ref9$useLocalStorage,\n            useLocalStorage,\n            _ref9$buttonPosition,\n            buttonPosition,\n            _ref9$apiKey,\n            apiKey,\n            _ref9$extraParams,\n            extraParams,\n            _yield$getTorusUrl2,\n            torusUrl,\n            logLevel,\n            dappStorageKey,\n            torusIframeUrl,\n            hashParams,\n            handleSetup,\n            _args4 = arguments;\n\n        return _regeneratorRuntime().wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                _ref9 = _args4.length > 0 && _args4[0] !== undefined ? _args4[0] : {}, _ref9$buildEnv = _ref9.buildEnv, buildEnv = _ref9$buildEnv === void 0 ? TORUS_BUILD_ENV.PRODUCTION : _ref9$buildEnv, _ref9$enableLogging = _ref9.enableLogging, enableLogging = _ref9$enableLogging === void 0 ? false : _ref9$enableLogging, network = _ref9.network, _ref9$showTorusButton = _ref9.showTorusButton, showTorusButton = _ref9$showTorusButton === void 0 ? false : _ref9$showTorusButton, _ref9$useLocalStorage = _ref9.useLocalStorage, useLocalStorage = _ref9$useLocalStorage === void 0 ? false : _ref9$useLocalStorage, _ref9$buttonPosition = _ref9.buttonPosition, buttonPosition = _ref9$buttonPosition === void 0 ? BUTTON_POSITION.BOTTOM_LEFT : _ref9$buttonPosition, _ref9$apiKey = _ref9.apiKey, apiKey = _ref9$apiKey === void 0 ? \"torus-default\" : _ref9$apiKey, _ref9$extraParams = _ref9.extraParams, extraParams = _ref9$extraParams === void 0 ? {} : _ref9$extraParams;\n\n                if (!this.isInitialized) {\n                  _context10.next = 3;\n                  break;\n                }\n\n                throw new Error(\"Already initialized\");\n\n              case 3:\n                setAPIKey(apiKey);\n                _context10.next = 6;\n                return getTorusUrl(buildEnv);\n\n              case 6:\n                _yield$getTorusUrl2 = _context10.sent;\n                torusUrl = _yield$getTorusUrl2.torusUrl;\n                logLevel = _yield$getTorusUrl2.logLevel;\n                log.enableAll();\n                log.info(torusUrl, \"url loaded\");\n                log.info(\"Solana Embed Version :\".concat(version));\n                this.torusUrl = torusUrl;\n                log.setDefaultLevel(logLevel);\n                if (enableLogging) log.enableAll();else log.disableAll();\n                dappStorageKey = this.handleDappStorageKey(useLocalStorage);\n                torusIframeUrl = new URL(torusUrl);\n                if (torusIframeUrl.pathname.endsWith(\"/\")) torusIframeUrl.pathname += \"frame\";else torusIframeUrl.pathname += \"/frame\";\n                hashParams = new URLSearchParams();\n                if (dappStorageKey) hashParams.append(\"dappStorageKey\", dappStorageKey);\n                hashParams.append(\"origin\", window.location.origin);\n                torusIframeUrl.hash = hashParams.toString(); // Iframe code\n\n                this.torusIframe = htmlToElement(\"<iframe\\n        id=\\\"torusIframe\\\"\\n        class=\\\"torusIframe\\\"\\n        src=\\\"\".concat(torusIframeUrl.href, \"\\\"\\n        style=\\\"display: none; position: fixed; top: 0; right: 0; width: 100%;\\n        height: 100%; border: none; border-radius: 0; z-index: \").concat(this.modalZIndex.toString(), \"\\\"\\n      ></iframe>\"));\n                this.torusAlertContainer = htmlToElement(\"<div id=\\\"torusAlertContainer\\\" style=\\\"display:none; z-index: \".concat(this.alertZIndex.toString(), \"\\\"></div>\"));\n                this.styleLink = htmlToElement(\"<link href=\\\"\".concat(torusUrl, \"/css/widget.css\\\" rel=\\\"stylesheet\\\" type=\\\"text/css\\\">\"));\n\n                handleSetup = /*#__PURE__*/function () {\n                  var _ref10 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee9() {\n                    return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n                      while (1) {\n                        switch (_context9.prev = _context9.next) {\n                          case 0:\n                            return _context9.abrupt(\"return\", new Promise(function (resolve, reject) {\n                              try {\n                                window.document.head.appendChild(_this12.styleLink);\n                                window.document.body.appendChild(_this12.torusIframe);\n                                window.document.body.appendChild(_this12.torusAlertContainer);\n\n                                _this12.torusIframe.addEventListener(\"load\", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8() {\n                                  var dappMetadata;\n                                  return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n                                    while (1) {\n                                      switch (_context8.prev = _context8.next) {\n                                        case 0:\n                                          _context8.next = 2;\n                                          return getSiteMetadata();\n\n                                        case 2:\n                                          dappMetadata = _context8.sent;\n\n                                          // send init params here\n                                          _this12.torusIframe.contentWindow.postMessage({\n                                            buttonPosition: buttonPosition,\n                                            apiKey: apiKey,\n                                            network: network,\n                                            dappMetadata: dappMetadata,\n                                            extraParams: extraParams\n                                          }, torusIframeUrl.origin);\n\n                                          _context8.next = 6;\n                                          return _this12._setupWeb3({\n                                            torusUrl: torusUrl\n                                          });\n\n                                        case 6:\n                                          if (showTorusButton) _this12.showTorusButton();else _this12.hideTorusButton();\n                                          _this12.isInitialized = true;\n                                          window.torus = _this12;\n                                          resolve();\n\n                                        case 10:\n                                        case \"end\":\n                                          return _context8.stop();\n                                      }\n                                    }\n                                  }, _callee8);\n                                })));\n                              } catch (error) {\n                                reject(error);\n                              }\n                            }));\n\n                          case 1:\n                          case \"end\":\n                            return _context9.stop();\n                        }\n                      }\n                    }, _callee9);\n                  }));\n\n                  return function handleSetup() {\n                    return _ref10.apply(this, arguments);\n                  };\n                }();\n\n                _context10.next = 28;\n                return documentReady();\n\n              case 28:\n                _context10.next = 30;\n                return handleSetup();\n\n              case 30:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10, this);\n      }));\n\n      function init() {\n        return _init.apply(this, arguments);\n      }\n\n      return init;\n    }()\n  }, {\n    key: \"login\",\n    value: function () {\n      var _login = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee11() {\n        var _this13 = this;\n\n        var params,\n            res,\n            _args5 = arguments;\n        return _regeneratorRuntime().wrap(function _callee11$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                params = _args5.length > 0 && _args5[0] !== undefined ? _args5[0] : {};\n\n                if (this.isInitialized) {\n                  _context11.next = 3;\n                  break;\n                }\n\n                throw new Error(\"Call init() first\");\n\n              case 3:\n                _context11.prev = 3;\n                this.requestedLoginProvider = params.loginProvider || null;\n\n                if (!this.requestedLoginProvider) {\n                  this.communicationProvider._displayIframe({\n                    isFull: true\n                  });\n                } // If user is already logged in, we assume they have given access to the website\n\n\n                _context11.next = 8;\n                return new Promise(function (resolve, reject) {\n                  // We use this method because we want to update inPage provider state with account info\n                  _this13.provider._rpcRequest({\n                    method: \"solana_requestAccounts\",\n                    params: [_this13.requestedLoginProvider, params.login_hint]\n                  }, getRpcPromiseCallback(resolve, reject));\n                });\n\n              case 8:\n                res = _context11.sent;\n\n                if (!(Array.isArray(res) && res.length > 0)) {\n                  _context11.next = 11;\n                  break;\n                }\n\n                return _context11.abrupt(\"return\", res);\n\n              case 11:\n                throw new Error(\"Login failed\");\n\n              case 14:\n                _context11.prev = 14;\n                _context11.t0 = _context11[\"catch\"](3);\n                log.error(\"login failed\", _context11.t0);\n                throw _context11.t0;\n\n              case 18:\n                _context11.prev = 18;\n                if (this.communicationProvider.isIFrameFullScreen) this.communicationProvider._displayIframe();\n                return _context11.finish(18);\n\n              case 21:\n              case \"end\":\n                return _context11.stop();\n            }\n          }\n        }, _callee11, this, [[3, 14, 18, 21]]);\n      }));\n\n      function login() {\n        return _login.apply(this, arguments);\n      }\n\n      return login;\n    }()\n  }, {\n    key: \"loginWithPrivateKey\",\n    value: function () {\n      var _loginWithPrivateKey = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee12(loginParams) {\n        var privateKey, userInfo, _yield$this$communica, success;\n\n        return _regeneratorRuntime().wrap(function _callee12$(_context12) {\n          while (1) {\n            switch (_context12.prev = _context12.next) {\n              case 0:\n                if (this.isInitialized) {\n                  _context12.next = 2;\n                  break;\n                }\n\n                throw new Error(\"Call init() first\");\n\n              case 2:\n                privateKey = loginParams.privateKey, userInfo = loginParams.userInfo;\n                _context12.next = 5;\n                return this.communicationProvider.request({\n                  method: \"login_with_private_key\",\n                  params: {\n                    privateKey: privateKey,\n                    userInfo: userInfo\n                  }\n                });\n\n              case 5:\n                _yield$this$communica = _context12.sent;\n                success = _yield$this$communica.success;\n\n                if (success) {\n                  _context12.next = 9;\n                  break;\n                }\n\n                throw new Error(\"Login Failed\");\n\n              case 9:\n              case \"end\":\n                return _context12.stop();\n            }\n          }\n        }, _callee12, this);\n      }));\n\n      function loginWithPrivateKey(_x7) {\n        return _loginWithPrivateKey.apply(this, arguments);\n      }\n\n      return loginWithPrivateKey;\n    }()\n  }, {\n    key: \"logout\",\n    value: function () {\n      var _logout = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee13() {\n        return _regeneratorRuntime().wrap(function _callee13$(_context13) {\n          while (1) {\n            switch (_context13.prev = _context13.next) {\n              case 0:\n                if (this.communicationProvider.isLoggedIn) {\n                  _context13.next = 2;\n                  break;\n                }\n\n                throw new Error(\"Not logged in\");\n\n              case 2:\n                _context13.next = 4;\n                return this.communicationProvider.request({\n                  method: COMMUNICATION_JRPC_METHODS.LOGOUT,\n                  params: []\n                });\n\n              case 4:\n                this.requestedLoginProvider = null;\n\n              case 5:\n              case \"end\":\n                return _context13.stop();\n            }\n          }\n        }, _callee13, this);\n      }));\n\n      function logout() {\n        return _logout.apply(this, arguments);\n      }\n\n      return logout;\n    }()\n  }, {\n    key: \"cleanUp\",\n    value: function () {\n      var _cleanUp = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee14() {\n        return _regeneratorRuntime().wrap(function _callee14$(_context14) {\n          while (1) {\n            switch (_context14.prev = _context14.next) {\n              case 0:\n                if (!this.communicationProvider.isLoggedIn) {\n                  _context14.next = 3;\n                  break;\n                }\n\n                _context14.next = 3;\n                return this.logout();\n\n              case 3:\n                this.clearInit();\n\n              case 4:\n              case \"end\":\n                return _context14.stop();\n            }\n          }\n        }, _callee14, this);\n      }));\n\n      function cleanUp() {\n        return _cleanUp.apply(this, arguments);\n      }\n\n      return cleanUp;\n    }()\n  }, {\n    key: \"clearInit\",\n    value: function clearInit() {\n      function isElement(element) {\n        return element instanceof Element || element instanceof Document;\n      }\n\n      if (isElement(this.styleLink) && window.document.body.contains(this.styleLink)) {\n        this.styleLink.remove();\n        this.styleLink = undefined;\n      }\n\n      if (isElement(this.torusIframe) && window.document.body.contains(this.torusIframe)) {\n        this.torusIframe.remove();\n        this.torusIframe = undefined;\n      }\n\n      if (isElement(this.torusAlertContainer) && window.document.body.contains(this.torusAlertContainer)) {\n        this.torusAlert = undefined;\n        this.torusAlertContainer.remove();\n        this.torusAlertContainer = undefined;\n      }\n\n      this.isInitialized = false;\n    }\n  }, {\n    key: \"hideTorusButton\",\n    value: function hideTorusButton() {\n      this.communicationProvider.hideTorusButton();\n    }\n  }, {\n    key: \"showTorusButton\",\n    value: function showTorusButton() {\n      this.communicationProvider.showTorusButton();\n    }\n  }, {\n    key: \"setProvider\",\n    value: function () {\n      var _setProvider = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee15(params) {\n        return _regeneratorRuntime().wrap(function _callee15$(_context15) {\n          while (1) {\n            switch (_context15.prev = _context15.next) {\n              case 0:\n                _context15.next = 2;\n                return this.communicationProvider.request({\n                  method: COMMUNICATION_JRPC_METHODS.SET_PROVIDER,\n                  params: _objectSpread({}, params)\n                });\n\n              case 2:\n              case \"end\":\n                return _context15.stop();\n            }\n          }\n        }, _callee15, this);\n      }));\n\n      function setProvider(_x8) {\n        return _setProvider.apply(this, arguments);\n      }\n\n      return setProvider;\n    }()\n  }, {\n    key: \"showWallet\",\n    value: function () {\n      var _showWallet = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee16(path) {\n        var params,\n            instanceId,\n            finalPath,\n            finalUrl,\n            walletWindow,\n            _args10 = arguments;\n        return _regeneratorRuntime().wrap(function _callee16$(_context16) {\n          while (1) {\n            switch (_context16.prev = _context16.next) {\n              case 0:\n                params = _args10.length > 1 && _args10[1] !== undefined ? _args10[1] : {};\n                _context16.next = 3;\n                return this.communicationProvider.request({\n                  method: COMMUNICATION_JRPC_METHODS.WALLET_INSTANCE_ID,\n                  params: []\n                });\n\n              case 3:\n                instanceId = _context16.sent;\n                finalPath = path ? \"/\".concat(path) : \"\";\n                finalUrl = new URL(\"\".concat(this.torusUrl, \"/wallet\").concat(finalPath)); // Using URL constructor to prevent js injection and allow parameter validation.!\n\n                finalUrl.searchParams.append(\"instanceId\", instanceId);\n                Object.keys(params).forEach(function (x) {\n                  finalUrl.searchParams.append(x, params[x]);\n                });\n\n                if (this.dappStorageKey) {\n                  finalUrl.hash = \"#dappStorageKey=\".concat(this.dappStorageKey);\n                } // No need to track this window state. Hence, no _handleWindow call.\n\n\n                walletWindow = new PopupHandler({\n                  url: finalUrl,\n                  features: getPopupFeatures(FEATURES_DEFAULT_WALLET_WINDOW)\n                });\n                walletWindow.open();\n\n              case 11:\n              case \"end\":\n                return _context16.stop();\n            }\n          }\n        }, _callee16, this);\n      }));\n\n      function showWallet(_x9) {\n        return _showWallet.apply(this, arguments);\n      }\n\n      return showWallet;\n    }()\n  }, {\n    key: \"getUserInfo\",\n    value: function () {\n      var _getUserInfo = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee17() {\n        var userInfoResponse;\n        return _regeneratorRuntime().wrap(function _callee17$(_context17) {\n          while (1) {\n            switch (_context17.prev = _context17.next) {\n              case 0:\n                _context17.next = 2;\n                return this.communicationProvider.request({\n                  method: COMMUNICATION_JRPC_METHODS.USER_INFO,\n                  params: []\n                });\n\n              case 2:\n                userInfoResponse = _context17.sent;\n                return _context17.abrupt(\"return\", userInfoResponse);\n\n              case 4:\n              case \"end\":\n                return _context17.stop();\n            }\n          }\n        }, _callee17, this);\n      }));\n\n      function getUserInfo() {\n        return _getUserInfo.apply(this, arguments);\n      }\n\n      return getUserInfo;\n    }()\n  }, {\n    key: \"initiateTopup\",\n    value: function () {\n      var _initiateTopup = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee18(provider, params) {\n        var windowId, topupResponse;\n        return _regeneratorRuntime().wrap(function _callee18$(_context18) {\n          while (1) {\n            switch (_context18.prev = _context18.next) {\n              case 0:\n                if (this.isInitialized) {\n                  _context18.next = 2;\n                  break;\n                }\n\n                throw new Error(\"Torus is not initialized\");\n\n              case 2:\n                windowId = getWindowId();\n\n                this.communicationProvider._handleWindow(windowId);\n\n                _context18.next = 6;\n                return this.communicationProvider.request({\n                  method: COMMUNICATION_JRPC_METHODS.TOPUP,\n                  params: {\n                    provider: provider,\n                    params: params,\n                    windowId: windowId\n                  }\n                });\n\n              case 6:\n                topupResponse = _context18.sent;\n                return _context18.abrupt(\"return\", topupResponse);\n\n              case 8:\n              case \"end\":\n                return _context18.stop();\n            }\n          }\n        }, _callee18, this);\n      }));\n\n      function initiateTopup(_x10, _x11) {\n        return _initiateTopup.apply(this, arguments);\n      }\n\n      return initiateTopup;\n    }() // Solana specific API\n\n  }, {\n    key: \"getAccounts\",\n    value: function () {\n      var _getAccounts = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee19() {\n        var response;\n        return _regeneratorRuntime().wrap(function _callee19$(_context19) {\n          while (1) {\n            switch (_context19.prev = _context19.next) {\n              case 0:\n                _context19.next = 2;\n                return this.provider.request({\n                  method: \"getAccounts\",\n                  params: []\n                });\n\n              case 2:\n                response = _context19.sent;\n                return _context19.abrupt(\"return\", response);\n\n              case 4:\n              case \"end\":\n                return _context19.stop();\n            }\n          }\n        }, _callee19, this);\n      }));\n\n      function getAccounts() {\n        return _getAccounts.apply(this, arguments);\n      }\n\n      return getAccounts;\n    }()\n  }, {\n    key: \"sendTransaction\",\n    value: function () {\n      var _sendTransaction = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee20(transaction) {\n        var response;\n        return _regeneratorRuntime().wrap(function _callee20$(_context20) {\n          while (1) {\n            switch (_context20.prev = _context20.next) {\n              case 0:\n                _context20.next = 2;\n                return this.provider.request({\n                  method: \"send_transaction\",\n                  params: {\n                    message: transaction.serialize({\n                      requireAllSignatures: false\n                    }).toString(\"hex\")\n                  }\n                });\n\n              case 2:\n                response = _context20.sent;\n                return _context20.abrupt(\"return\", response);\n\n              case 4:\n              case \"end\":\n                return _context20.stop();\n            }\n          }\n        }, _callee20, this);\n      }));\n\n      function sendTransaction(_x12) {\n        return _sendTransaction.apply(this, arguments);\n      }\n\n      return sendTransaction;\n    }()\n  }, {\n    key: \"signTransaction\",\n    value: function () {\n      var _signTransaction = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee21(transaction) {\n        var response, parsed, signature;\n        return _regeneratorRuntime().wrap(function _callee21$(_context21) {\n          while (1) {\n            switch (_context21.prev = _context21.next) {\n              case 0:\n                _context21.next = 2;\n                return this.provider.request({\n                  method: \"sign_transaction\",\n                  params: {\n                    message: transaction.serializeMessage().toString(\"hex\"),\n                    messageOnly: true\n                  }\n                });\n\n              case 2:\n                response = _context21.sent;\n                // reconstruct signature pair\n                parsed = JSON.parse(response);\n                signature = {\n                  publicKey: new PublicKey(parsed.publicKey),\n                  signature: Buffer.from(parsed.signature, \"hex\")\n                };\n                transaction.addSignature(signature.publicKey, signature.signature);\n                return _context21.abrupt(\"return\", transaction);\n\n              case 7:\n              case \"end\":\n                return _context21.stop();\n            }\n          }\n        }, _callee21, this);\n      }));\n\n      function signTransaction(_x13) {\n        return _signTransaction.apply(this, arguments);\n      }\n\n      return signTransaction;\n    }()\n  }, {\n    key: \"signAllTransactions\",\n    value: function () {\n      var _signAllTransactions = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee22(transactions) {\n        var encodedMessage, responses, signatures;\n        return _regeneratorRuntime().wrap(function _callee22$(_context22) {\n          while (1) {\n            switch (_context22.prev = _context22.next) {\n              case 0:\n                encodedMessage = transactions.map(function (tx) {\n                  return tx.serializeMessage().toString(\"hex\");\n                });\n                _context22.next = 3;\n                return this.provider.request({\n                  method: \"sign_all_transactions\",\n                  params: {\n                    message: encodedMessage,\n                    messageOnly: true\n                  }\n                });\n\n              case 3:\n                responses = _context22.sent;\n                // reconstruct signature pairs\n                signatures = responses.map(function (item) {\n                  var parsed = JSON.parse(item);\n                  return {\n                    publicKey: new PublicKey(parsed.publicKey),\n                    signature: Buffer.from(parsed.signature, \"hex\")\n                  };\n                });\n                transactions.forEach(function (tx, idx) {\n                  tx.addSignature(signatures[idx].publicKey, signatures[idx].signature);\n                  return tx;\n                });\n                return _context22.abrupt(\"return\", transactions);\n\n              case 7:\n              case \"end\":\n                return _context22.stop();\n            }\n          }\n        }, _callee22, this);\n      }));\n\n      function signAllTransactions(_x14) {\n        return _signAllTransactions.apply(this, arguments);\n      }\n\n      return signAllTransactions;\n    }()\n  }, {\n    key: \"signMessage\",\n    value: function () {\n      var _signMessage = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee23(data) {\n        var response;\n        return _regeneratorRuntime().wrap(function _callee23$(_context23) {\n          while (1) {\n            switch (_context23.prev = _context23.next) {\n              case 0:\n                _context23.next = 2;\n                return this.provider.request({\n                  method: \"sign_message\",\n                  params: {\n                    data: data\n                  }\n                });\n\n              case 2:\n                response = _context23.sent;\n                return _context23.abrupt(\"return\", response);\n\n              case 4:\n              case \"end\":\n                return _context23.stop();\n            }\n          }\n        }, _callee23, this);\n      }));\n\n      function signMessage(_x15) {\n        return _signMessage.apply(this, arguments);\n      }\n\n      return signMessage;\n    }()\n  }, {\n    key: \"getGaslessPublicKey\",\n    value: function () {\n      var _getGaslessPublicKey = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee24() {\n        var response;\n        return _regeneratorRuntime().wrap(function _callee24$(_context24) {\n          while (1) {\n            switch (_context24.prev = _context24.next) {\n              case 0:\n                _context24.next = 2;\n                return this.provider.request({\n                  method: \"get_gasless_public_key\",\n                  params: []\n                });\n\n              case 2:\n                response = _context24.sent;\n                return _context24.abrupt(\"return\", response);\n\n              case 4:\n              case \"end\":\n                return _context24.stop();\n            }\n          }\n        }, _callee24, this);\n      }));\n\n      function getGaslessPublicKey() {\n        return _getGaslessPublicKey.apply(this, arguments);\n      }\n\n      return getGaslessPublicKey;\n    }() // async connect(): Promise<boolean> {\n    //   const response = (await this.provider.request({\n    //     method: \"connect\",\n    //     params: {},\n    //   })) as boolean;\n    //   return response;\n    // }\n\n  }, {\n    key: \"handleDappStorageKey\",\n    value: function handleDappStorageKey(useLocalStorage) {\n      var dappStorageKey = \"\";\n\n      if (isLocalStorageAvailable && useLocalStorage) {\n        var storedKey = window.localStorage.getItem(configuration.localStorageKey);\n        if (storedKey) dappStorageKey = storedKey;else {\n          var generatedKey = \"torus-app-\".concat(getWindowId());\n          window.localStorage.setItem(configuration.localStorageKey, generatedKey);\n          dappStorageKey = generatedKey;\n        }\n      }\n\n      this.dappStorageKey = dappStorageKey;\n      return dappStorageKey;\n    }\n  }, {\n    key: \"_setupWeb3\",\n    value: function () {\n      var _setupWeb = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee25(providerParams) {\n        var _this14 = this;\n\n        var providerStream, communicationStream, inPageProvider, communicationProvider, detectAccountRequestPrototypeModifier, proxiedInPageProvider, proxiedCommunicationProvider;\n        return _regeneratorRuntime().wrap(function _callee25$(_context25) {\n          while (1) {\n            switch (_context25.prev = _context25.next) {\n              case 0:\n                log.info(\"setupWeb3 running\"); // setup background connection\n\n                providerStream = new BasePostMessageStream({\n                  name: \"embed_torus\",\n                  target: \"iframe_torus\",\n                  targetWindow: this.torusIframe.contentWindow\n                }); // We create another LocalMessageDuplexStream for communication between dapp <> iframe\n\n                communicationStream = new BasePostMessageStream({\n                  name: \"embed_communication\",\n                  target: \"iframe_communication\",\n                  targetWindow: this.torusIframe.contentWindow\n                }); // compose the inPage provider\n\n                inPageProvider = new TorusInPageProvider(providerStream, {});\n                communicationProvider = new TorusCommunicationProvider(communicationStream, {});\n\n                inPageProvider.tryWindowHandle = function (payload, cb) {\n                  var _payload = payload;\n\n                  if (!Array.isArray(_payload) && PROVIDER_UNSAFE_METHODS.includes(_payload.method)) {\n                    if (!_this14.communicationProvider.isLoggedIn) throw new Error(\"User Not Logged In\");\n                    var windowId = getWindowId();\n\n                    communicationProvider._handleWindow(windowId, {\n                      target: \"_blank\",\n                      features: getPopupFeatures(FEATURES_CONFIRM_WINDOW)\n                    }); // for inPageProvider methods sending windowId in request instead of params\n                    // as params might be positional.\n\n\n                    _payload.windowId = windowId;\n                  }\n\n                  inPageProvider._rpcEngine.handle(_payload, cb);\n                };\n\n                communicationProvider.tryWindowHandle = function (payload, cb) {\n                  var _payload = payload;\n\n                  if (!Array.isArray(_payload) && COMMUNICATION_UNSAFE_METHODS.includes(_payload.method)) {\n                    var windowId = getWindowId();\n\n                    communicationProvider._handleWindow(windowId, {\n                      target: \"_blank\",\n                      features: getPopupFeatures(FEATURES_PROVIDER_CHANGE_WINDOW) // todo: are these features generic for all\n\n                    }); // for communication methods sending window id in jrpc req params\n\n\n                    _payload.params.windowId = windowId;\n                  }\n\n                  communicationProvider._rpcEngine.handle(_payload, cb);\n                }; // detect solana_requestAccounts and pipe to enable for now\n\n\n                detectAccountRequestPrototypeModifier = function detectAccountRequestPrototypeModifier(m) {\n                  var originalMethod = inPageProvider[m]; // eslint-disable-next-line @typescript-eslint/no-this-alias\n\n                  var self = _this14;\n\n                  inPageProvider[m] = function providerFunc(request, cb) {\n                    var method = request.method,\n                        _request$params = request.params,\n                        params = _request$params === void 0 ? [] : _request$params;\n\n                    if (method === \"solana_requestAccounts\") {\n                      if (!cb) return self.login({\n                        loginProvider: params[0]\n                      });\n                      self.login({\n                        loginProvider: params[0]\n                      }) // eslint-disable-next-line promise/no-callback-in-promise\n                      .then(function (res) {\n                        return cb(null, res);\n                      }) // eslint-disable-next-line promise/no-callback-in-promise\n                      .catch(function (err) {\n                        return cb(err);\n                      });\n                    }\n\n                    return originalMethod.apply(this, [request, cb]);\n                  };\n                }; // Detects call to solana_requestAccounts in request & sendAsync and passes to login\n\n\n                detectAccountRequestPrototypeModifier(\"request\");\n                detectAccountRequestPrototypeModifier(\"sendAsync\");\n                detectAccountRequestPrototypeModifier(\"send\");\n                proxiedInPageProvider = new Proxy(inPageProvider, {\n                  // straight up lie that we deleted the property so that it doesn't\n                  // throw an error in strict mode\n                  deleteProperty: function deleteProperty() {\n                    return true;\n                  }\n                });\n                proxiedCommunicationProvider = new Proxy(communicationProvider, {\n                  // straight up lie that we deleted the property so that it doesn't\n                  // throw an error in strict mode\n                  deleteProperty: function deleteProperty() {\n                    return true;\n                  }\n                });\n                this.provider = proxiedInPageProvider;\n                this.communicationProvider = proxiedCommunicationProvider;\n                _context25.next = 17;\n                return Promise.all([inPageProvider._initializeState(), communicationProvider._initializeState(_objectSpread(_objectSpread({}, providerParams), {}, {\n                  dappStorageKey: this.dappStorageKey,\n                  torusAlertContainer: this.torusAlertContainer,\n                  torusIframe: this.torusIframe\n                }))]);\n\n              case 17:\n                log.debug(\"Torus - injected provider\");\n\n              case 18:\n              case \"end\":\n                return _context25.stop();\n            }\n          }\n        }, _callee25, this);\n      }));\n\n      function _setupWeb3(_x16) {\n        return _setupWeb.apply(this, arguments);\n      }\n\n      return _setupWeb3;\n    }()\n  }]);\n\n  return Torus;\n}();\n\nexport { BUTTON_POSITION, LOGIN_PROVIDER, PAYMENT_PROVIDER, TORUS_BUILD_ENV, TorusInPageProvider, Torus as default };","map":{"version":3,"mappings":"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","names":["errors","disconnected","permanentlyDisconnected","unsupportedSync","method","invalidDuplexStream","invalidOptions","maxEventListeners","invalidRequestArgs","invalidRequestMethod","invalidRequestParams","invalidLoggerObject","invalidLoggerMethod","info","connected","chainId","warnings","PAYMENT_PROVIDER","MOONPAY","WYRE","RAMPNETWORK","XANPOOL","MERCURYO","TRANSAK","TORUS_BUILD_ENV","PRODUCTION","DEVELOPMENT","TESTING","BUTTON_POSITION","BOTTOM_LEFT","TOP_LEFT","BOTTOM_RIGHT","TOP_RIGHT","LOGIN_PROVIDER","GOOGLE","FACEBOOK","REDDIT","DISCORD","TWITCH","APPLE","LINE","GITHUB","KAKAO","LINKEDIN","TWITTER","WEIBO","WECHAT","EMAIL_PASSWORDLESS","translations","en","embed","continue","actionRequired","pendingAction","cookiesRequired","enableCookies","clickHere","de","ja","ko","zh","supportedVerifierList","api","prodTorusUrl","localStorageKey","window","location","hostname","loglevel","getLogger","createErrorMiddleware","req","res","next","error","ethErrors","rpc","invalidRequest","message","data","done","log","logStreamDisconnectWarning","remoteLabel","emitter","warningMsg","stack","warn","listenerCount","emit","getWindowId","Math","random","toString","slice","getTorusUrl","buildEnv","torusUrl","logLevel","getUserLanguage","userLanguage","navigator","language","userLanguages","split","Object","prototype","hasOwnProperty","call","config","FEATURES_PROVIDER_CHANGE_WINDOW","height","width","FEATURES_DEFAULT_WALLET_WINDOW","FEATURES_DEFAULT_POPUP_WINDOW","FEATURES_CONFIRM_WINDOW","storageAvailable","type","storage","x","setItem","removeItem","e","code","name","length","getPopupFeatures","_ref","w","h","dualScreenLeft","screenLeft","undefined","screenX","dualScreenTop","screenTop","screenY","innerWidth","document","documentElement","clientWidth","screen","innerHeight","clientHeight","systemZoom","left","abs","top","features","BaseProvider","constructor","connectionStream","jsonRpcStreamName","_defineProperty","isDuplexStream","Error","messages","isTorus","setMaxListeners","_handleConnect","bind","_handleDisconnect","_handleStreamDisconnect","_rpcRequest","_initializeState","request","sendAsync","mux","ObjectMultiplex","pump","ignoreStream","jsonRpcConnection","createStreamMiddleware","stream","createStream","rpcEngine","JRPCEngine","push","createIdRemapMiddleware","createLoggerMiddleware","origin","middleware","_rpcEngine","jsonRpcConnectionEvents","events","args","Array","isArray","params","Promise","resolve","reject","getRpcPromiseCallback","send","payload","callback","streamName","SafeEventEmitter","handleEvent","handle","eventName","handler","handlerArgs","arguments","handlerWrapper","removeEventListener","addEventListener","documentReady","readyState","htmlToElement","html","template","createElement","trimmedHtml","trim","innerHTML","content","firstChild","PopupHandler","url","target","windowTimer","iClosedWindow","_setupTimer","Number","setInterval","closed","clearInterval","open","href","focus","close","redirect","locationReplaceOnRedirect","replace","TorusCommunicationProvider","_state","_defaultState","dappStorageKey","languageTranslations","configuration","embedTranslations","windowRefs","on","isConnected","notificationHandler","COMMUNICATION_NOTIFICATIONS","IFRAME_STATUS","isFullScreen","rid","_displayIframe","isFull","CREATE_WINDOW","windowId","_createPopupBlockAlert","CLOSE_WINDOW","_handleCloseWindow","USER_LOGGED_IN","currentLoginProvider","isLoggedIn","USER_LOGGED_OUT","isIFrameFullScreen","torusAlertContainer","torusIframe","COMMUNICATION_JRPC_METHODS","GET_PROVIDER_STATE","initialized","_handleWindow","finalUrl","URL","concat","hash","handledWindow","OPENED_WINDOW","once","CLOSED_WINDOW","style","display","torusWidgetVisibility","buttonPosition","right","bottom","assign","hideTorusButton","showTorusButton","cb","_payload","jsonrpc","tryWindowHandle","debug","isRecoverable","errorMessage","isPermanentlyDisconnected","EthereumRpcError","logoUrl","getLogoUrl","torusAlert","successAlert","btnContainer","appendChild","bindOnLoad","remove","children","attachOnLoad","hasEmittedConnection","TorusInPageProvider","selectedAddress","_handleAccountsChanged","_handleChainChanged","_handleUnlockStateChanged","jsonRpcNotificationHandler","PROVIDER_NOTIFICATIONS","ACCOUNTS_CHANGED","UNLOCK_STATE_CHANGED","CHAIN_CHANGED","PROVIDER_JRPC_METHODS","accounts","isUnlocked","isInternal","err","result","isEthAccounts","finalAccounts","account","dequal","imgExists","img","onload","onerror","src","getSiteName","siteName","querySelector","metaTitle","title","getSiteIcon","icon","from","querySelectorAll","find","_icon","Boolean","getSiteMetadata","require","version","PROVIDER_UNSAFE_METHODS","COMMUNICATION_UNSAFE_METHODS","SET_PROVIDER","isLocalStorageAvailable","torusIframeHtml","crossOrigin","rel","relList","supports","head","preLoadIframe","Torus","modalZIndex","isInitialized","requestedLoginProvider","alertZIndex","communicationProvider","enableLogging","network","useLocalStorage","apiKey","extraParams","setAPIKey","enableAll","setDefaultLevel","disableAll","handleDappStorageKey","torusIframeUrl","pathname","endsWith","hashParams","URLSearchParams","append","styleLink","handleSetup","body","dappMetadata","contentWindow","postMessage","_setupWeb3","torus","loginProvider","provider","login_hint","loginParams","privateKey","userInfo","success","LOGOUT","logout","clearInit","isElement","element","Element","Document","contains","path","WALLET_INSTANCE_ID","instanceId","finalPath","searchParams","keys","forEach","walletWindow","USER_INFO","userInfoResponse","TOPUP","topupResponse","response","transaction","serialize","requireAllSignatures","serializeMessage","messageOnly","parsed","JSON","parse","signature","publicKey","PublicKey","Buffer","addSignature","transactions","encodedMessage","map","tx","responses","signatures","item","idx","storedKey","localStorage","getItem","generatedKey","providerParams","providerStream","BasePostMessageStream","targetWindow","communicationStream","inPageProvider","includes","detectAccountRequestPrototypeModifier","m","originalMethod","self","providerFunc","login","then","catch","apply","proxiedInPageProvider","Proxy","deleteProperty","proxiedCommunicationProvider","all"],"sources":["../src/messages.ts","../src/interfaces.ts","../src/config.ts","../src/loglevel.ts","../src/utils.ts","../src/baseProvider.ts","../src/embedUtils.ts","../src/PopupHandler.ts","../src/communicationProvider.ts","../src/inPageProvider.ts","../src/siteMetadata.ts","../src/embed.ts"],"sourcesContent":[null,null,null,null,null,null,null,null,null,null,null,null]},"metadata":{},"sourceType":"module"}