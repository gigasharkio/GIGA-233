{"ast":null,"code":"import _createForOfIteratorHelper from \"/Users/nicksampah/Repository/Three.js/Gigashark-v2/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _classCallCheck from \"/Users/nicksampah/Repository/Three.js/Gigashark-v2/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/nicksampah/Repository/Three.js/Gigashark-v2/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _assertThisInitialized from \"/Users/nicksampah/Repository/Three.js/Gigashark-v2/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _inherits from \"/Users/nicksampah/Repository/Three.js/Gigashark-v2/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/nicksampah/Repository/Three.js/Gigashark-v2/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport _asyncToGenerator from \"/Users/nicksampah/Repository/Three.js/Gigashark-v2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _regeneratorRuntime from \"/Users/nicksampah/Repository/Three.js/Gigashark-v2/node_modules/@babel/runtime/regenerator/index.js\";\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { Transaction } from '@solana/web3.js';\nimport { createLoggerMiddleware, COMMUNICATION_JRPC_METHODS, COMMUNICATION_NOTIFICATIONS, PROVIDER_JRPC_METHODS, PROVIDER_NOTIFICATIONS } from '@toruslabs/base-controllers';\nimport { setAPIKey } from '@toruslabs/http-helpers';\nimport { SafeEventEmitter, ObjectMultiplex, createStreamMiddleware, JRPCEngine, createIdRemapMiddleware, getRpcPromiseCallback, BasePostMessageStream } from '@toruslabs/openlogin-jrpc';\nimport { ethErrors, EthereumRpcError } from 'eth-rpc-errors';\nimport { isDuplexStream } from 'is-stream';\nimport pump from 'pump';\nimport loglevel from 'loglevel';\nimport dequal from 'fast-deep-equal';\nvar messages = {\n  errors: {\n    disconnected: function disconnected() {\n      return \"Torus: Lost connection to Torus.\";\n    },\n    permanentlyDisconnected: function permanentlyDisconnected() {\n      return \"Torus: Disconnected from iframe. Page reload required.\";\n    },\n    unsupportedSync: function unsupportedSync(method) {\n      return \"Torus: The Torus Ethereum provider does not support synchronous methods like \".concat(method, \" without a callback parameter.\");\n    },\n    invalidDuplexStream: function invalidDuplexStream() {\n      return \"Must provide a Node.js-style duplex stream.\";\n    },\n    invalidOptions: function invalidOptions(maxEventListeners) {\n      return \"Invalid options. Received: { maxEventListeners: \".concat(maxEventListeners, \"}\");\n    },\n    invalidRequestArgs: function invalidRequestArgs() {\n      return \"Expected a single, non-array, object argument.\";\n    },\n    invalidRequestMethod: function invalidRequestMethod() {\n      return \"'args.method' must be a non-empty string.\";\n    },\n    invalidRequestParams: function invalidRequestParams() {\n      return \"'args.params' must be an object or array if provided.\";\n    },\n    invalidLoggerObject: function invalidLoggerObject() {\n      return \"'args.logger' must be an object if provided.\";\n    },\n    invalidLoggerMethod: function invalidLoggerMethod(method) {\n      return \"'args.logger' must include required method '\".concat(method, \"'.\");\n    }\n  },\n  info: {\n    connected: function connected(chainId) {\n      return \"Torus: Connected to chain with ID \\\"\".concat(chainId, \"\\\".\");\n    }\n  },\n  warnings: {}\n};\nvar PAYMENT_PROVIDER = {\n  MOONPAY: \"moonpay\",\n  WYRE: \"wyre\",\n  RAMPNETWORK: \"rampnetwork\",\n  XANPOOL: \"xanpool\",\n  MERCURYO: \"mercuryo\",\n  TRANSAK: \"transak\"\n};\nvar TORUS_BUILD_ENV = {\n  PRODUCTION: \"production\",\n  DEVELOPMENT: \"development\",\n  TESTING: \"testing\"\n};\nvar BUTTON_POSITION = {\n  BOTTOM_LEFT: \"bottom-left\",\n  TOP_LEFT: \"top-left\",\n  BOTTOM_RIGHT: \"bottom-right\",\n  TOP_RIGHT: \"top-right\"\n};\nvar LOGIN_PROVIDER = {\n  GOOGLE: \"google\",\n  FACEBOOK: \"facebook\",\n  REDDIT: \"reddit\",\n  DISCORD: \"discord\",\n  TWITCH: \"twitch\",\n  APPLE: \"apple\",\n  LINE: \"line\",\n  GITHUB: \"github\",\n  KAKAO: \"kakao\",\n  LINKEDIN: \"linkedin\",\n  TWITTER: \"twitter\",\n  WEIBO: \"weibo\",\n  WECHAT: \"wechat\",\n  EMAIL_PASSWORDLESS: \"email_passwordless\"\n};\nvar translations = {\n  en: {\n    embed: {\n      continue: \"Continue\",\n      actionRequired: \"Authorization required\",\n      pendingAction: \"Click continue to proceed with your request in a popup\",\n      cookiesRequired: \"Cookies Required\",\n      enableCookies: \"Please enable cookies in your browser preferences to access Torus\",\n      clickHere: \"More Info\"\n    }\n  },\n  de: {\n    embed: {\n      continue: \"Fortsetzen\",\n      actionRequired: \"Autorisierung erforderlich\",\n      pendingAction: \"Klicken Sie in einem Popup auf Weiter, um mit Ihrer Anfrage fortzufahren\",\n      cookiesRequired: \"Cookies benötigt\",\n      enableCookies: \"Bitte aktivieren Sie Cookies in Ihren Browsereinstellungen, um auf Torus zuzugreifen\",\n      clickHere: \"Mehr Info\"\n    }\n  },\n  ja: {\n    embed: {\n      continue: \"継続する\",\n      actionRequired: \"認証が必要です\",\n      pendingAction: \"続行をクリックして、ポップアップでリクエストを続行します\",\n      cookiesRequired: \"必要なクッキー\",\n      enableCookies: \"Torusにアクセスするには、ブラウザの設定でCookieを有効にしてください。\",\n      clickHere: \"詳しくは\"\n    }\n  },\n  ko: {\n    embed: {\n      continue: \"계속하다\",\n      actionRequired: \"승인 필요\",\n      pendingAction: \"팝업에서 요청을 진행하려면 계속을 클릭하십시오.\",\n      cookiesRequired: \"쿠키 필요\",\n      enableCookies: \"브라우저 환경 설정에서 쿠키를 활성화하여 Torus에 액세스하십시오.\",\n      clickHere: \"더 많은 정보\"\n    }\n  },\n  zh: {\n    embed: {\n      continue: \"继续\",\n      actionRequired: \"需要授权\",\n      pendingAction: \"单击继续以在弹出窗口中继续您的请求\",\n      cookiesRequired: \"必填Cookie\",\n      enableCookies: \"请在您的浏览器首选项中启用cookie以访问Torus。\",\n      clickHere: \"更多信息\"\n    }\n  }\n};\nvar configuration = {\n  supportedVerifierList: [LOGIN_PROVIDER.GOOGLE, LOGIN_PROVIDER.REDDIT, LOGIN_PROVIDER.DISCORD],\n  api: \"https://api.tor.us\",\n  translations: translations,\n  prodTorusUrl: \"\",\n  localStorageKey: \"torus-\".concat(window.location.hostname)\n};\nvar log = loglevel.getLogger(\"solana-embed\");\n/**\n * json-rpc-engine middleware that logs RPC errors and and validates req.method.\n *\n * @param log - The logging API to use.\n * @returns  json-rpc-engine middleware function\n */\n\nfunction createErrorMiddleware() {\n  return function (req, res, next) {\n    // json-rpc-engine will terminate the request when it notices this error\n    if (typeof req.method !== \"string\" || !req.method) {\n      res.error = ethErrors.rpc.invalidRequest({\n        message: \"The request 'method' must be a non-empty string.\",\n        data: req\n      });\n    }\n\n    next(function (done) {\n      var error = res.error;\n\n      if (!error) {\n        return done();\n      }\n\n      log.error(\"Torus - RPC Error: \".concat(error.message), error);\n      return done();\n    });\n  };\n}\n/**\n * Logs a stream disconnection error. Emits an 'error' if given an\n * EventEmitter that has listeners for the 'error' event.\n *\n * @param log - The logging API to use.\n * @param remoteLabel - The label of the disconnected stream.\n * @param error - The associated error to log.\n * @param emitter - The logging API to use.\n */\n\n\nfunction logStreamDisconnectWarning(remoteLabel, error, emitter) {\n  var warningMsg = \"Torus: Lost connection to \\\"\".concat(remoteLabel, \"\\\".\");\n\n  if (error !== null && error !== void 0 && error.stack) {\n    warningMsg += \"\\n\".concat(error.stack);\n  }\n\n  log.warn(warningMsg);\n\n  if (emitter && emitter.listenerCount(\"error\") > 0) {\n    emitter.emit(\"error\", warningMsg);\n  }\n}\n\nvar getWindowId = function getWindowId() {\n  return Math.random().toString(36).slice(2);\n};\n\nvar getTorusUrl = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(buildEnv) {\n    var torusUrl, logLevel;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.t0 = buildEnv;\n            _context.next = _context.t0 === \"testing\" ? 3 : _context.t0 === \"development\" ? 6 : 9;\n            break;\n\n          case 3:\n            torusUrl = \"https://solana-testing.tor.us\";\n            logLevel = \"debug\";\n            return _context.abrupt(\"break\", 12);\n\n          case 6:\n            torusUrl = \"http://localhost:8080\";\n            logLevel = \"debug\";\n            return _context.abrupt(\"break\", 12);\n\n          case 9:\n            torusUrl = \"https://solana.tor.us\";\n            logLevel = \"error\";\n            return _context.abrupt(\"break\", 12);\n\n          case 12:\n            return _context.abrupt(\"return\", {\n              torusUrl: torusUrl,\n              logLevel: logLevel\n            });\n\n          case 13:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function getTorusUrl(_x) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nvar getUserLanguage = function getUserLanguage() {\n  var userLanguage = window.navigator.language || \"en-US\";\n  var userLanguages = userLanguage.split(\"-\");\n  userLanguage = Object.prototype.hasOwnProperty.call(configuration.translations, userLanguages[0]) ? userLanguages[0] : \"en\";\n  return userLanguage;\n};\n\nvar FEATURES_PROVIDER_CHANGE_WINDOW = {\n  height: 660,\n  width: 375\n};\nvar FEATURES_DEFAULT_WALLET_WINDOW = {\n  height: 740,\n  width: 1315\n};\nvar FEATURES_DEFAULT_POPUP_WINDOW = {\n  height: 700,\n  width: 1200\n};\nvar FEATURES_CONFIRM_WINDOW = {\n  height: 600,\n  width: 400\n};\n\nfunction storageAvailable(type) {\n  var storage;\n\n  try {\n    storage = window[type];\n    var x = \"__storage_test__\";\n    storage.setItem(x, x);\n    storage.removeItem(x);\n    return true;\n  } catch (e) {\n    return e && ( // everything except Firefox\n    e.code === 22 || // Firefox\n    e.code === 1014 || // test name field too, because code might not be present\n    // everything except Firefox\n    e.name === \"QuotaExceededError\" || // Firefox\n    e.name === \"NS_ERROR_DOM_QUOTA_REACHED\") && // acknowledge QuotaExceededError only if there's something already stored\n    storage && storage.length !== 0;\n  }\n}\n/**\n * popup handler utils\n */\n\n\nfunction getPopupFeatures(_ref) {\n  var w = _ref.width,\n      h = _ref.height; // Fixes dual-screen position                             Most browsers      Firefox\n\n  var dualScreenLeft = window.screenLeft !== undefined ? window.screenLeft : window.screenX;\n  var dualScreenTop = window.screenTop !== undefined ? window.screenTop : window.screenY;\n  var width = window.innerWidth ? window.innerWidth : document.documentElement.clientWidth ? document.documentElement.clientWidth : window.screen.width;\n  var height = window.innerHeight ? window.innerHeight : document.documentElement.clientHeight ? document.documentElement.clientHeight : window.screen.height;\n  var systemZoom = 1; // No reliable estimate\n\n  var left = Math.abs((width - w) / 2 / systemZoom + dualScreenLeft);\n  var top = Math.abs((height - h) / 2 / systemZoom + dualScreenTop);\n  var features = \"titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=\".concat(h / systemZoom, \",width=\").concat(w / systemZoom, \",top=\").concat(top, \",left=\").concat(left);\n  return features;\n}\n\nvar getNetworkConfig = function getNetworkConfig(label) {\n  switch (label) {\n    case \"mainnet-beta\":\n      return {\n        blockExplorerUrl: \"https://explorer.solana.com\",\n        chainId: \"0x1\",\n        displayName: \"Solana Mainnet\",\n        logo: \"solana.svg\",\n        rpcTarget: \"https://api.mainnet-beta.solana.com\",\n        ticker: \"SOL\",\n        tickerName: \"Solana Token\"\n      };\n\n    case \"testnet\":\n      return {\n        blockExplorerUrl: \"https://explorer.solana.com\",\n        chainId: \"0x2\",\n        displayName: \"Solana Testnet\",\n        logo: \"solana.svg\",\n        rpcTarget: \"https://api.testnet.solana.com\",\n        ticker: \"SOL\",\n        tickerName: \"Solana Token\"\n      };\n\n    case \"devnet\":\n      return {\n        blockExplorerUrl: \"https://explorer.solana.com\",\n        chainId: \"0x3\",\n        displayName: \"Solana Devnet\",\n        logo: \"solana.svg\",\n        rpcTarget: \"https://api.devnet.solana.com\",\n        ticker: \"SOL\",\n        tickerName: \"Solana Token\"\n      };\n\n    default:\n      return undefined;\n  }\n};\n\nvar BaseProvider = /*#__PURE__*/function (_SafeEventEmitter) {\n  _inherits(BaseProvider, _SafeEventEmitter);\n\n  var _super = _createSuper(BaseProvider);\n\n  /**\n   * Indicating that this provider is a Torus provider.\n   */\n  function BaseProvider(connectionStream, _ref) {\n    var _this;\n\n    _classCallCheck(this, BaseProvider);\n\n    var _ref$maxEventListener = _ref.maxEventListeners,\n        maxEventListeners = _ref$maxEventListener === void 0 ? 100 : _ref$maxEventListener,\n        _ref$jsonRpcStreamNam = _ref.jsonRpcStreamName,\n        jsonRpcStreamName = _ref$jsonRpcStreamNam === void 0 ? \"provider\" : _ref$jsonRpcStreamNam;\n    _this = _super.call(this);\n\n    _defineProperty(_assertThisInitialized(_this), \"isTorus\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"_rpcEngine\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"jsonRpcConnectionEvents\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"_state\", void 0);\n\n    if (!isDuplexStream(connectionStream)) {\n      throw new Error(messages.errors.invalidDuplexStream());\n    }\n\n    _this.isTorus = true;\n\n    _this.setMaxListeners(maxEventListeners);\n\n    _this._handleConnect = _this._handleConnect.bind(_assertThisInitialized(_this));\n    _this._handleDisconnect = _this._handleDisconnect.bind(_assertThisInitialized(_this));\n    _this._handleStreamDisconnect = _this._handleStreamDisconnect.bind(_assertThisInitialized(_this));\n    _this._rpcRequest = _this._rpcRequest.bind(_assertThisInitialized(_this));\n    _this._initializeState = _this._initializeState.bind(_assertThisInitialized(_this));\n    _this.request = _this.request.bind(_assertThisInitialized(_this));\n    _this.sendAsync = _this.sendAsync.bind(_assertThisInitialized(_this)); // this.enable = this.enable.bind(this);\n    // setup connectionStream multiplexing\n\n    var mux = new ObjectMultiplex();\n    pump(connectionStream, mux, connectionStream, _this._handleStreamDisconnect.bind(_assertThisInitialized(_this), \"Torus\")); // ignore phishing warning message (handled elsewhere)\n\n    mux.ignoreStream(\"phishing\"); // setup own event listeners\n    // connect to async provider\n\n    var jsonRpcConnection = createStreamMiddleware();\n    pump(jsonRpcConnection.stream, mux.createStream(jsonRpcStreamName), jsonRpcConnection.stream, _this._handleStreamDisconnect.bind(_assertThisInitialized(_this), \"Torus RpcProvider\")); // handle RPC requests via dapp-side rpc engine\n\n    var rpcEngine = new JRPCEngine();\n    rpcEngine.push(createIdRemapMiddleware());\n    rpcEngine.push(createErrorMiddleware());\n    rpcEngine.push(createLoggerMiddleware({\n      origin: location.origin\n    }));\n    rpcEngine.push(jsonRpcConnection.middleware);\n    _this._rpcEngine = rpcEngine;\n    _this.jsonRpcConnectionEvents = jsonRpcConnection.events;\n    return _this;\n  }\n  /**\n   * Submits an RPC request for the given method, with the given params.\n   * Resolves with the result of the method call, or rejects on error.\n   */\n\n\n  _createClass(BaseProvider, [{\n    key: \"request\",\n    value: function () {\n      var _request = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(args) {\n        var _this2 = this;\n\n        var method, params;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!(!args || typeof args !== \"object\" || Array.isArray(args))) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                throw ethErrors.rpc.invalidRequest({\n                  message: messages.errors.invalidRequestArgs(),\n                  data: args\n                });\n\n              case 2:\n                method = args.method, params = args.params;\n\n                if (!(typeof method !== \"string\" || method.length === 0)) {\n                  _context2.next = 5;\n                  break;\n                }\n\n                throw ethErrors.rpc.invalidRequest({\n                  message: messages.errors.invalidRequestMethod(),\n                  data: args\n                });\n\n              case 5:\n                if (!(params !== undefined && !Array.isArray(params) && (typeof params !== \"object\" || params === null))) {\n                  _context2.next = 7;\n                  break;\n                }\n\n                throw ethErrors.rpc.invalidRequest({\n                  message: messages.errors.invalidRequestParams(),\n                  data: args\n                });\n\n              case 7:\n                return _context2.abrupt(\"return\", new Promise(function (resolve, reject) {\n                  _this2._rpcRequest({\n                    method: method,\n                    params: params\n                  }, getRpcPromiseCallback(resolve, reject));\n                }));\n\n              case 8:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      function request(_x2) {\n        return _request.apply(this, arguments);\n      }\n\n      return request;\n    }()\n    /**\n     * Submits an RPC request per the given JSON-RPC request object.\n     */\n\n  }, {\n    key: \"send\",\n    value: function send(payload, callback) {\n      this._rpcRequest(payload, callback);\n    }\n    /**\n     * Submits an RPC request per the given JSON-RPC request object.\n     */\n\n  }, {\n    key: \"sendAsync\",\n    value: function sendAsync(payload) {\n      var _this3 = this;\n\n      return new Promise(function (resolve, reject) {\n        _this3._rpcRequest(payload, getRpcPromiseCallback(resolve, reject));\n      });\n    }\n    /**\n     * Called when connection is lost to critical streams.\n     *\n     * emits TorusInpageProvider#disconnect\n     */\n\n  }, {\n    key: \"_handleStreamDisconnect\",\n    value: function _handleStreamDisconnect(streamName, error) {\n      logStreamDisconnectWarning(streamName, error, this);\n\n      this._handleDisconnect(false, error ? error.message : undefined);\n    }\n  }]);\n\n  return BaseProvider;\n}(SafeEventEmitter);\n\nvar handleEvent = function handleEvent(handle, eventName, handler) {\n  for (var _len = arguments.length, handlerArgs = new Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {\n    handlerArgs[_key - 3] = arguments[_key];\n  }\n\n  var handlerWrapper = function handlerWrapper() {\n    handler.apply(void 0, handlerArgs);\n    handle.removeEventListener(eventName, handlerWrapper);\n  };\n\n  handle.addEventListener(eventName, handlerWrapper);\n};\n\nfunction documentReady() {\n  return _documentReady.apply(this, arguments);\n}\n\nfunction _documentReady() {\n  _documentReady = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee24() {\n    return _regeneratorRuntime.wrap(function _callee24$(_context24) {\n      while (1) {\n        switch (_context24.prev = _context24.next) {\n          case 0:\n            return _context24.abrupt(\"return\", new Promise(function (resolve) {\n              if (document.readyState !== \"loading\") {\n                resolve();\n              } else {\n                handleEvent(document, \"DOMContentLoaded\", resolve);\n              }\n            }));\n\n          case 1:\n          case \"end\":\n            return _context24.stop();\n        }\n      }\n    }, _callee24);\n  }));\n  return _documentReady.apply(this, arguments);\n}\n\nvar htmlToElement = function htmlToElement(html) {\n  var template = window.document.createElement(\"template\");\n  var trimmedHtml = html.trim(); // Never return a text node of whitespace as the result\n\n  template.innerHTML = trimmedHtml;\n  return template.content.firstChild;\n};\n\nvar PopupHandler = /*#__PURE__*/function (_SafeEventEmitter2) {\n  _inherits(PopupHandler, _SafeEventEmitter2);\n\n  var _super2 = _createSuper(PopupHandler);\n\n  function PopupHandler(_ref) {\n    var _this4;\n\n    _classCallCheck(this, PopupHandler);\n\n    var url = _ref.url,\n        target = _ref.target,\n        features = _ref.features;\n    _this4 = _super2.call(this);\n\n    _defineProperty(_assertThisInitialized(_this4), \"url\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this4), \"target\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this4), \"features\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this4), \"window\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this4), \"windowTimer\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this4), \"iClosedWindow\", void 0);\n\n    _this4.url = url;\n    _this4.target = target || \"_blank\";\n    _this4.features = features || getPopupFeatures(FEATURES_DEFAULT_POPUP_WINDOW);\n    _this4.window = undefined;\n    _this4.windowTimer = undefined;\n    _this4.iClosedWindow = false;\n\n    _this4._setupTimer();\n\n    return _this4;\n  }\n\n  _createClass(PopupHandler, [{\n    key: \"_setupTimer\",\n    value: function _setupTimer() {\n      var _this5 = this;\n\n      this.windowTimer = Number(setInterval(function () {\n        if (_this5.window && _this5.window.closed) {\n          clearInterval(_this5.windowTimer);\n\n          if (!_this5.iClosedWindow) {\n            _this5.emit(\"close\");\n          }\n\n          _this5.iClosedWindow = false;\n          _this5.window = undefined;\n        }\n\n        if (_this5.window === undefined) clearInterval(_this5.windowTimer);\n      }, 500));\n    }\n  }, {\n    key: \"open\",\n    value: function open() {\n      var _this$window;\n\n      this.window = window.open(this.url.href, this.target, this.features);\n      if ((_this$window = this.window) !== null && _this$window !== void 0 && _this$window.focus) this.window.focus();\n      return Promise.resolve();\n    }\n  }, {\n    key: \"close\",\n    value: function close() {\n      this.iClosedWindow = true;\n      if (this.window) this.window.close();\n    }\n  }, {\n    key: \"redirect\",\n    value: function redirect(locationReplaceOnRedirect) {\n      if (locationReplaceOnRedirect) {\n        window.location.replace(this.url.href);\n      } else {\n        window.location.href = this.url.href;\n      }\n    }\n  }]);\n\n  return PopupHandler;\n}(SafeEventEmitter);\n\nfunction ownKeys$2(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread$2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys$2(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys$2(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n\nvar TorusCommunicationProvider = /*#__PURE__*/function (_BaseProvider) {\n  _inherits(TorusCommunicationProvider, _BaseProvider);\n\n  var _super3 = _createSuper(TorusCommunicationProvider);\n\n  function TorusCommunicationProvider(connectionStream, _ref) {\n    var _this6;\n\n    _classCallCheck(this, TorusCommunicationProvider);\n\n    var _ref$maxEventListener2 = _ref.maxEventListeners,\n        maxEventListeners = _ref$maxEventListener2 === void 0 ? 100 : _ref$maxEventListener2,\n        _ref$jsonRpcStreamNam2 = _ref.jsonRpcStreamName,\n        jsonRpcStreamName = _ref$jsonRpcStreamNam2 === void 0 ? \"provider\" : _ref$jsonRpcStreamNam2;\n    _this6 = _super3.call(this, connectionStream, {\n      maxEventListeners: maxEventListeners,\n      jsonRpcStreamName: jsonRpcStreamName\n    }); // private state\n\n    _defineProperty(_assertThisInitialized(_this6), \"embedTranslations\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this6), \"torusUrl\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this6), \"dappStorageKey\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this6), \"windowRefs\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this6), \"tryWindowHandle\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this6), \"torusAlertContainer\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this6), \"torusIframe\", void 0);\n\n    _this6._state = _objectSpread$2({}, TorusCommunicationProvider._defaultState); // public state\n\n    _this6.torusUrl = \"\";\n    _this6.dappStorageKey = \"\";\n    var languageTranslations = configuration.translations[getUserLanguage()];\n    _this6.embedTranslations = languageTranslations.embed;\n    _this6.windowRefs = {}; // setup own event listeners\n    // EIP-1193 connect\n\n    _this6.on(\"connect\", function () {\n      _this6._state.isConnected = true;\n    });\n\n    var notificationHandler = function notificationHandler(payload) {\n      var method = payload.method,\n          params = payload.params;\n\n      if (method === COMMUNICATION_NOTIFICATIONS.IFRAME_STATUS) {\n        var isFullScreen = params.isFullScreen,\n            rid = params.rid;\n\n        _this6._displayIframe({\n          isFull: isFullScreen,\n          rid: rid\n        });\n      } else if (method === COMMUNICATION_NOTIFICATIONS.CREATE_WINDOW) {\n        var windowId = params.windowId,\n            url = params.url;\n\n        _this6._createPopupBlockAlert(windowId, url);\n      } else if (method === COMMUNICATION_NOTIFICATIONS.CLOSE_WINDOW) {\n        _this6._handleCloseWindow(params);\n      } else if (method === COMMUNICATION_NOTIFICATIONS.USER_LOGGED_IN) {\n        var currentLoginProvider = params.currentLoginProvider;\n        _this6._state.isLoggedIn = true;\n        _this6._state.currentLoginProvider = currentLoginProvider;\n      } else if (method === COMMUNICATION_NOTIFICATIONS.USER_LOGGED_OUT) {\n        _this6._state.isLoggedIn = false;\n        _this6._state.currentLoginProvider = null;\n\n        _this6._displayIframe();\n      }\n    };\n\n    _this6.jsonRpcConnectionEvents.on(\"notification\", notificationHandler);\n\n    return _this6;\n  }\n\n  _createClass(TorusCommunicationProvider, [{\n    key: \"isLoggedIn\",\n    get: function get() {\n      return this._state.isLoggedIn;\n    }\n  }, {\n    key: \"isIFrameFullScreen\",\n    get: function get() {\n      return this._state.isIFrameFullScreen;\n    }\n    /**\n     * Returns whether the inPage provider is connected to Torus.\n     */\n\n  }, {\n    key: \"isConnected\",\n    value: function isConnected() {\n      return this._state.isConnected;\n    }\n  }, {\n    key: \"_initializeState\",\n    value: function () {\n      var _initializeState2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(params) {\n        var _this7 = this;\n\n        var torusUrl, dappStorageKey, torusAlertContainer, torusIframe, _yield$this$request, currentLoginProvider, isLoggedIn;\n\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.prev = 0;\n                torusUrl = params.torusUrl, dappStorageKey = params.dappStorageKey, torusAlertContainer = params.torusAlertContainer, torusIframe = params.torusIframe;\n                this.torusUrl = torusUrl;\n                this.dappStorageKey = dappStorageKey;\n                this.torusAlertContainer = torusAlertContainer;\n                this.torusIframe = torusIframe;\n                this.torusIframe.addEventListener(\"load\", function () {\n                  // only do this if iframe is not full screen\n                  if (!_this7._state.isIFrameFullScreen) _this7._displayIframe();\n                });\n                _context3.next = 9;\n                return this.request({\n                  method: COMMUNICATION_JRPC_METHODS.GET_PROVIDER_STATE,\n                  params: []\n                });\n\n              case 9:\n                _yield$this$request = _context3.sent;\n                currentLoginProvider = _yield$this$request.currentLoginProvider;\n                isLoggedIn = _yield$this$request.isLoggedIn;\n\n                // indicate that we've connected, for EIP-1193 compliance\n                this._handleConnect(currentLoginProvider, isLoggedIn);\n\n                _context3.next = 18;\n                break;\n\n              case 15:\n                _context3.prev = 15;\n                _context3.t0 = _context3[\"catch\"](0);\n                log.error(\"Torus: Failed to get initial state. Please report this bug.\", _context3.t0);\n\n              case 18:\n                _context3.prev = 18;\n                log.info(\"initialized communication state\");\n                this._state.initialized = true;\n                this.emit(\"_initialized\");\n                return _context3.finish(18);\n\n              case 23:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[0, 15, 18, 23]]);\n      }));\n\n      function _initializeState(_x3) {\n        return _initializeState2.apply(this, arguments);\n      }\n\n      return _initializeState;\n    }()\n  }, {\n    key: \"_handleWindow\",\n    value: function _handleWindow(windowId) {\n      var _this8 = this;\n\n      var _ref3 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n          url = _ref3.url,\n          target = _ref3.target,\n          features = _ref3.features;\n\n      var finalUrl = new URL(url || \"\".concat(this.torusUrl, \"/redirect?windowId=\").concat(windowId));\n\n      if (this.dappStorageKey) {\n        // If multiple instances, it returns the first one\n        if (finalUrl.hash) finalUrl.hash += \"&dappStorageKey=\".concat(this.dappStorageKey);else finalUrl.hash = \"#dappStorageKey=\".concat(this.dappStorageKey);\n      }\n\n      var handledWindow = new PopupHandler({\n        url: finalUrl,\n        target: target,\n        features: features\n      });\n      handledWindow.open();\n\n      if (!handledWindow.window) {\n        this._createPopupBlockAlert(windowId, finalUrl.href);\n\n        return;\n      } // Add to collection only if window is opened\n\n\n      this.windowRefs[windowId] = handledWindow; // We tell the iframe that the window has been successfully opened\n\n      this.request({\n        method: COMMUNICATION_JRPC_METHODS.OPENED_WINDOW,\n        params: {\n          windowId: windowId\n        }\n      });\n      handledWindow.once(\"close\", function () {\n        // user closed the window\n        delete _this8.windowRefs[windowId];\n\n        _this8.request({\n          method: COMMUNICATION_JRPC_METHODS.CLOSED_WINDOW,\n          params: {\n            windowId: windowId\n          }\n        });\n      });\n    }\n  }, {\n    key: \"_displayIframe\",\n    value: function _displayIframe() {\n      var _ref4 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          _ref4$isFull = _ref4.isFull,\n          isFull = _ref4$isFull === void 0 ? false : _ref4$isFull,\n          _ref4$rid = _ref4.rid,\n          rid = _ref4$rid === void 0 ? \"\" : _ref4$rid;\n\n      var style = {}; // set phase\n\n      if (!isFull) {\n        style.display = this._state.torusWidgetVisibility ? \"block\" : \"none\";\n        style.height = \"70px\";\n        style.width = \"70px\";\n\n        switch (this._state.buttonPosition) {\n          case BUTTON_POSITION.TOP_LEFT:\n            style.top = \"0px\";\n            style.left = \"0px\";\n            style.right = \"auto\";\n            style.bottom = \"auto\";\n            break;\n\n          case BUTTON_POSITION.TOP_RIGHT:\n            style.top = \"0px\";\n            style.right = \"0px\";\n            style.left = \"auto\";\n            style.bottom = \"auto\";\n            break;\n\n          case BUTTON_POSITION.BOTTOM_RIGHT:\n            style.bottom = \"0px\";\n            style.right = \"0px\";\n            style.top = \"auto\";\n            style.left = \"auto\";\n            break;\n\n          case BUTTON_POSITION.BOTTOM_LEFT:\n          default:\n            style.bottom = \"0px\";\n            style.left = \"0px\";\n            style.top = \"auto\";\n            style.right = \"auto\";\n            break;\n        }\n      } else {\n        style.display = \"block\";\n        style.width = \"100%\";\n        style.height = \"100%\";\n        style.top = \"0px\";\n        style.right = \"0px\";\n        style.left = \"0px\";\n        style.bottom = \"0px\";\n      }\n\n      Object.assign(this.torusIframe.style, style);\n      this._state.isIFrameFullScreen = isFull;\n      this.request({\n        method: COMMUNICATION_JRPC_METHODS.IFRAME_STATUS,\n        params: {\n          isIFrameFullScreen: isFull,\n          rid: rid\n        }\n      });\n    }\n  }, {\n    key: \"hideTorusButton\",\n    value: function hideTorusButton() {\n      this._state.torusWidgetVisibility = false;\n\n      this._displayIframe();\n    }\n  }, {\n    key: \"showTorusButton\",\n    value: function showTorusButton() {\n      this._state.torusWidgetVisibility = true;\n\n      this._displayIframe();\n    }\n    /**\n     * Internal RPC method. Forwards requests to background via the RPC engine.\n     * Also remap ids inbound and outbound\n     */\n\n  }, {\n    key: \"_rpcRequest\",\n    value: function _rpcRequest(payload, callback) {\n      var cb = callback;\n      var _payload = payload;\n\n      if (!Array.isArray(_payload)) {\n        if (!_payload.jsonrpc) {\n          _payload.jsonrpc = \"2.0\";\n        }\n      }\n\n      this.tryWindowHandle(_payload, cb);\n    }\n    /**\n     * When the provider becomes connected, updates internal state and emits\n     * required events. Idempotent.\n     *\n     * @param currentLoginProvider - The login Provider\n     * emits TorusInpageProvider#connect\n     */\n\n  }, {\n    key: \"_handleConnect\",\n    value: function _handleConnect(currentLoginProvider, isLoggedIn) {\n      if (!this._state.isConnected) {\n        this._state.isConnected = true;\n        this.emit(\"connect\", {\n          currentLoginProvider: currentLoginProvider,\n          isLoggedIn: isLoggedIn\n        });\n        log.debug(messages.info.connected(currentLoginProvider));\n      }\n    }\n    /**\n     * When the provider becomes disconnected, updates internal state and emits\n     * required events. Idempotent with respect to the isRecoverable parameter.\n     *\n     * Error codes per the CloseEvent status codes as required by EIP-1193:\n     * https://developer.mozilla.org/en-US/docs/Web/API/CloseEvent#Status_codes\n     *\n     * @param isRecoverable - Whether the disconnection is recoverable.\n     * @param errorMessage - A custom error message.\n     * emits TorusInpageProvider#disconnect\n     */\n\n  }, {\n    key: \"_handleDisconnect\",\n    value: function _handleDisconnect(isRecoverable, errorMessage) {\n      if (this._state.isConnected || !this._state.isPermanentlyDisconnected && !isRecoverable) {\n        this._state.isConnected = false;\n        var error;\n\n        if (isRecoverable) {\n          error = new EthereumRpcError(1013, // Try again later\n          errorMessage || messages.errors.disconnected());\n          log.debug(error);\n        } else {\n          error = new EthereumRpcError(1011, // Internal error\n          errorMessage || messages.errors.permanentlyDisconnected());\n          log.error(error);\n          this._state.currentLoginProvider = null;\n          this._state.isLoggedIn = false;\n          this._state.torusWidgetVisibility = false;\n          this._state.isIFrameFullScreen = false;\n          this._state.isPermanentlyDisconnected = true;\n        }\n\n        this.emit(\"disconnect\", error);\n      }\n    } // Called if the iframe wants to close the window cause it is done processing the request\n\n  }, {\n    key: \"_handleCloseWindow\",\n    value: function _handleCloseWindow(params) {\n      var windowId = params.windowId;\n\n      if (this.windowRefs[windowId]) {\n        this.windowRefs[windowId].close();\n        delete this.windowRefs[windowId];\n      }\n    }\n  }, {\n    key: \"_createPopupBlockAlert\",\n    value: function () {\n      var _createPopupBlockAlert2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(windowId, url) {\n        var _this9 = this;\n\n        var logoUrl, torusAlert, successAlert, btnContainer, bindOnLoad, attachOnLoad;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                logoUrl = this.getLogoUrl();\n                torusAlert = htmlToElement('<div id=\"torusAlert\" class=\"torus-alert--v2\">' + \"<div id=\\\"torusAlert__logo\\\"><img src=\\\"\".concat(logoUrl, \"\\\" /></div>\") + \"<div>\" + \"<h1 id=\\\"torusAlert__title\\\">\".concat(this.embedTranslations.actionRequired, \"</h1>\") + \"<p id=\\\"torusAlert__desc\\\">\".concat(this.embedTranslations.pendingAction, \"</p>\") + \"</div>\" + \"</div>\");\n                successAlert = htmlToElement(\"<div><a id=\\\"torusAlert__btn\\\">\".concat(this.embedTranslations.continue, \"</a></div>\"));\n                btnContainer = htmlToElement('<div id=\"torusAlert__btn-container\"></div>');\n                btnContainer.appendChild(successAlert);\n                torusAlert.appendChild(btnContainer);\n\n                bindOnLoad = function bindOnLoad() {\n                  successAlert.addEventListener(\"click\", function () {\n                    _this9._handleWindow(windowId, {\n                      url: url,\n                      target: \"_blank\",\n                      features: getPopupFeatures(FEATURES_CONFIRM_WINDOW)\n                    });\n\n                    torusAlert.remove();\n                    if (_this9.torusAlertContainer.children.length === 0) _this9.torusAlertContainer.style.display = \"none\";\n                  });\n                };\n\n                attachOnLoad = function attachOnLoad() {\n                  _this9.torusAlertContainer.appendChild(torusAlert);\n                };\n\n                _context4.next = 10;\n                return documentReady();\n\n              case 10:\n                attachOnLoad();\n                bindOnLoad();\n                this.torusAlertContainer.style.display = \"block\";\n\n              case 13:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function _createPopupBlockAlert(_x4, _x5) {\n        return _createPopupBlockAlert2.apply(this, arguments);\n      }\n\n      return _createPopupBlockAlert;\n    }()\n  }, {\n    key: \"getLogoUrl\",\n    value: function getLogoUrl() {\n      var logoUrl = \"\".concat(this.torusUrl, \"/images/torus_icon-blue.svg\");\n      return logoUrl;\n    }\n  }]);\n\n  return TorusCommunicationProvider;\n}(BaseProvider);\n\n_defineProperty(TorusCommunicationProvider, \"_defaultState\", {\n  buttonPosition: \"bottom-left\",\n  currentLoginProvider: null,\n  isIFrameFullScreen: false,\n  hasEmittedConnection: false,\n  torusWidgetVisibility: false,\n  initialized: false,\n  isLoggedIn: false,\n  isPermanentlyDisconnected: false,\n  isConnected: false\n});\n\nfunction ownKeys$1(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread$1(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys$1(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys$1(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n\nvar TorusInPageProvider = /*#__PURE__*/function (_BaseProvider2) {\n  _inherits(TorusInPageProvider, _BaseProvider2);\n\n  var _super4 = _createSuper(TorusInPageProvider);\n\n  /**\n   * The chain ID of the currently connected Solana chain.\n   * See [chainId.network]{@link https://chainid.network} for more information.\n   */\n\n  /**\n   * The user's currently selected Solana address.\n   * If null, Torus is either locked or the user has not permitted any\n   * addresses to be viewed.\n   */\n  function TorusInPageProvider(connectionStream, _ref) {\n    var _this10;\n\n    _classCallCheck(this, TorusInPageProvider);\n\n    var _ref$maxEventListener3 = _ref.maxEventListeners,\n        maxEventListeners = _ref$maxEventListener3 === void 0 ? 100 : _ref$maxEventListener3,\n        _ref$jsonRpcStreamNam3 = _ref.jsonRpcStreamName,\n        jsonRpcStreamName = _ref$jsonRpcStreamNam3 === void 0 ? \"provider\" : _ref$jsonRpcStreamNam3;\n    _this10 = _super4.call(this, connectionStream, {\n      maxEventListeners: maxEventListeners,\n      jsonRpcStreamName: jsonRpcStreamName\n    }); // private state\n\n    _defineProperty(_assertThisInitialized(_this10), \"chainId\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this10), \"selectedAddress\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this10), \"tryWindowHandle\", void 0);\n\n    _this10._state = _objectSpread$1({}, TorusInPageProvider._defaultState); // public state\n\n    _this10.selectedAddress = null;\n    _this10.chainId = null;\n    _this10._handleAccountsChanged = _this10._handleAccountsChanged.bind(_assertThisInitialized(_this10));\n    _this10._handleChainChanged = _this10._handleChainChanged.bind(_assertThisInitialized(_this10));\n    _this10._handleUnlockStateChanged = _this10._handleUnlockStateChanged.bind(_assertThisInitialized(_this10)); // setup own event listeners\n    // EIP-1193 connect\n\n    _this10.on(\"connect\", function () {\n      _this10._state.isConnected = true;\n    });\n\n    var jsonRpcNotificationHandler = function jsonRpcNotificationHandler(payload) {\n      var method = payload.method,\n          params = payload.params;\n\n      if (method === PROVIDER_NOTIFICATIONS.ACCOUNTS_CHANGED) {\n        _this10._handleAccountsChanged(params);\n      } else if (method === PROVIDER_NOTIFICATIONS.UNLOCK_STATE_CHANGED) {\n        _this10._handleUnlockStateChanged(params);\n      } else if (method === PROVIDER_NOTIFICATIONS.CHAIN_CHANGED) {\n        _this10._handleChainChanged(params);\n      }\n    }; // json rpc notification listener\n\n\n    _this10.jsonRpcConnectionEvents.on(\"notification\", jsonRpcNotificationHandler);\n\n    return _this10;\n  }\n  /**\n   * Returns whether the inpage provider is connected to Torus.\n   */\n\n\n  _createClass(TorusInPageProvider, [{\n    key: \"isConnected\",\n    value: function isConnected() {\n      return this._state.isConnected;\n    } // Private Methods\n    //= ===================\n\n    /**\n     * Constructor helper.\n     * Populates initial state by calling 'wallet_getProviderState' and emits\n     * necessary events.\n     */\n\n  }, {\n    key: \"_initializeState\",\n    value: function () {\n      var _initializeState3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n        var _yield$this$request2, accounts, chainId, isUnlocked;\n\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.prev = 0;\n                _context5.next = 3;\n                return this.request({\n                  method: PROVIDER_JRPC_METHODS.GET_PROVIDER_STATE,\n                  params: []\n                });\n\n              case 3:\n                _yield$this$request2 = _context5.sent;\n                accounts = _yield$this$request2.accounts;\n                chainId = _yield$this$request2.chainId;\n                isUnlocked = _yield$this$request2.isUnlocked;\n                // indicate that we've connected, for EIP-1193 compliance\n                this.emit(\"connect\", {\n                  chainId: chainId\n                });\n\n                this._handleChainChanged({\n                  chainId: chainId\n                });\n\n                this._handleUnlockStateChanged({\n                  accounts: accounts,\n                  isUnlocked: isUnlocked\n                });\n\n                this._handleAccountsChanged(accounts);\n\n                _context5.next = 16;\n                break;\n\n              case 13:\n                _context5.prev = 13;\n                _context5.t0 = _context5[\"catch\"](0);\n                log.error(\"Torus: Failed to get initial state. Please report this bug.\", _context5.t0);\n\n              case 16:\n                _context5.prev = 16;\n                log.info(\"initialized provider state\");\n                this._state.initialized = true;\n                this.emit(\"_initialized\");\n                return _context5.finish(16);\n\n              case 21:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this, [[0, 13, 16, 21]]);\n      }));\n\n      function _initializeState() {\n        return _initializeState3.apply(this, arguments);\n      }\n\n      return _initializeState;\n    }()\n    /**\n     * Internal RPC method. Forwards requests to background via the RPC engine.\n     * Also remap ids inbound and outbound\n     */\n\n  }, {\n    key: \"_rpcRequest\",\n    value: function _rpcRequest(payload, callback) {\n      var _this11 = this;\n\n      var isInternal = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var cb = callback;\n      var _payload = payload;\n\n      if (!Array.isArray(_payload)) {\n        if (!_payload.jsonrpc) {\n          _payload.jsonrpc = \"2.0\";\n        }\n\n        if (_payload.method === \"solana_accounts\" || _payload.method === \"solana_requestAccounts\") {\n          // handle accounts changing\n          cb = function cb(err, res) {\n            _this11._handleAccountsChanged(res.result || [], _payload.method === \"solana_accounts\", isInternal);\n\n            callback(err, res);\n          };\n        } else if (_payload.method === \"wallet_getProviderState\") {\n          this._rpcEngine.handle(payload, cb);\n\n          return;\n        }\n      }\n\n      this.tryWindowHandle(_payload, cb);\n    }\n    /**\n     * When the provider becomes connected, updates internal state and emits\n     * required events. Idempotent.\n     *\n     * @param chainId - The ID of the newly connected chain.\n     * emits TorusInpageProvider#connect\n     */\n\n  }, {\n    key: \"_handleConnect\",\n    value: function _handleConnect(chainId) {\n      if (!this._state.isConnected) {\n        this._state.isConnected = true;\n        this.emit(\"connect\", {\n          chainId: chainId\n        });\n        log.debug(messages.info.connected(chainId));\n      }\n    }\n    /**\n     * When the provider becomes disconnected, updates internal state and emits\n     * required events. Idempotent with respect to the isRecoverable parameter.\n     *\n     * Error codes per the CloseEvent status codes as required by EIP-1193:\n     * https://developer.mozilla.org/en-US/docs/Web/API/CloseEvent#Status_codes\n     *\n     * @param isRecoverable - Whether the disconnection is recoverable.\n     * @param errorMessage - A custom error message.\n     * emits TorusInpageProvider#disconnect\n     */\n\n  }, {\n    key: \"_handleDisconnect\",\n    value: function _handleDisconnect(isRecoverable, errorMessage) {\n      if (this._state.isConnected || !this._state.isPermanentlyDisconnected && !isRecoverable) {\n        this._state.isConnected = false;\n        var error;\n\n        if (isRecoverable) {\n          error = new EthereumRpcError(1013, // Try again later\n          errorMessage || messages.errors.disconnected());\n          log.debug(error);\n        } else {\n          error = new EthereumRpcError(1011, // Internal error\n          errorMessage || messages.errors.permanentlyDisconnected());\n          log.error(error);\n          this.chainId = null;\n          this._state.accounts = null;\n          this.selectedAddress = null;\n          this._state.isUnlocked = false;\n          this._state.isPermanentlyDisconnected = true;\n        }\n\n        this.emit(\"disconnect\", error);\n      }\n    }\n    /**\n     * Called when accounts may have changed.\n     */\n\n  }, {\n    key: \"_handleAccountsChanged\",\n    value: function _handleAccountsChanged(accounts) {\n      var isEthAccounts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var isInternal = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false; // defensive programming\n\n      var finalAccounts = accounts;\n\n      if (!Array.isArray(finalAccounts)) {\n        log.error(\"Torus: Received non-array accounts parameter. Please report this bug.\", finalAccounts);\n        finalAccounts = [];\n      }\n\n      var _iterator = _createForOfIteratorHelper(accounts),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var account = _step.value;\n\n          if (typeof account !== \"string\") {\n            log.error(\"Torus: Received non-string account. Please report this bug.\", accounts);\n            finalAccounts = [];\n            break;\n          }\n        } // emit accountsChanged if anything about the accounts array has changed\n\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      if (!dequal(this._state.accounts, finalAccounts)) {\n        // we should always have the correct accounts even before solana_accounts\n        // returns, except in cases where isInternal is true\n        if (isEthAccounts && Array.isArray(this._state.accounts) && this._state.accounts.length > 0 && !isInternal) {\n          log.error('Torus: \"solana_accounts\" unexpectedly updated accounts. Please report this bug.', finalAccounts);\n        }\n\n        this._state.accounts = finalAccounts;\n        this.emit(\"accountsChanged\", finalAccounts);\n      } // handle selectedAddress\n\n\n      if (this.selectedAddress !== finalAccounts[0]) {\n        this.selectedAddress = finalAccounts[0] || null;\n      }\n    }\n    /**\n     * Upon receipt of a new chainId and networkVersion, emits corresponding\n     * events and sets relevant public state.\n     * Does nothing if neither the chainId nor the networkVersion are different\n     * from existing values.\n     *\n     * emits TorusInpageProvider#chainChanged\n     * @param networkInfo - An object with network info.\n     */\n\n  }, {\n    key: \"_handleChainChanged\",\n    value: function _handleChainChanged() {\n      var _ref5 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          chainId = _ref5.chainId;\n\n      if (!chainId) {\n        log.error(\"Torus: Received invalid network parameters. Please report this bug.\", {\n          chainId: chainId\n        });\n        return;\n      }\n\n      if (chainId === \"loading\") {\n        this._handleDisconnect(true);\n      } else {\n        this._handleConnect(chainId);\n\n        if (chainId !== this.chainId) {\n          this.chainId = chainId;\n\n          if (this._state.initialized) {\n            this.emit(\"chainChanged\", this.chainId);\n          }\n        }\n      }\n    }\n    /**\n     * Upon receipt of a new isUnlocked state, sets relevant public state.\n     * Calls the accounts changed handler with the received accounts, or an empty\n     * array.\n     *\n     * Does nothing if the received value is equal to the existing value.\n     * There are no lock/unlock events.\n     *\n     * @param opts - Options bag.\n     */\n\n  }, {\n    key: \"_handleUnlockStateChanged\",\n    value: function _handleUnlockStateChanged() {\n      var _ref6 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          accounts = _ref6.accounts,\n          isUnlocked = _ref6.isUnlocked;\n\n      if (typeof isUnlocked !== \"boolean\") {\n        log.error(\"Torus: Received invalid isUnlocked parameter. Please report this bug.\", {\n          isUnlocked: isUnlocked\n        });\n        return;\n      }\n\n      if (isUnlocked !== this._state.isUnlocked) {\n        this._state.isUnlocked = isUnlocked;\n\n        this._handleAccountsChanged(accounts || []);\n      }\n    }\n  }]);\n\n  return TorusInPageProvider;\n}(BaseProvider);\n\n_defineProperty(TorusInPageProvider, \"_defaultState\", {\n  accounts: null,\n  isConnected: false,\n  isUnlocked: false,\n  initialized: false,\n  isPermanentlyDisconnected: false,\n  hasEmittedConnection: false\n});\n/**\n * Returns whether the given image URL exists\n */\n\n\nfunction imgExists(url) {\n  return new Promise(function (resolve, reject) {\n    try {\n      var img = document.createElement(\"img\");\n\n      img.onload = function () {\n        return resolve(true);\n      };\n\n      img.onerror = function () {\n        return resolve(false);\n      };\n\n      img.src = url;\n    } catch (e) {\n      reject(e);\n    }\n  });\n}\n/**\n * Extracts a name for the site from the DOM\n */\n\n\nvar getSiteName = function getSiteName(window) {\n  var document = window.document;\n  var siteName = document.querySelector('head > meta[property=\"og:site_name\"]');\n\n  if (siteName) {\n    return siteName.content;\n  }\n\n  var metaTitle = document.querySelector('head > meta[name=\"title\"]');\n\n  if (metaTitle) {\n    return metaTitle.content;\n  }\n\n  if (document.title && document.title.length > 0) {\n    return document.title;\n  }\n\n  return window.location.hostname;\n};\n/**\n * Extracts an icon for the site from the DOM\n */\n\n\nfunction getSiteIcon(_x6) {\n  return _getSiteIcon.apply(this, arguments);\n}\n/**\n * Gets site metadata and returns it\n *\n */\n\n\nfunction _getSiteIcon() {\n  _getSiteIcon = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee25(window) {\n    var _document, icon;\n\n    return _regeneratorRuntime.wrap(function _callee25$(_context25) {\n      while (1) {\n        switch (_context25.prev = _context25.next) {\n          case 0:\n            _context25.prev = 0;\n            _document = window.document; // Use the site's favicon if it exists\n\n            icon = _document.querySelector('head > link[rel=\"shortcut icon\"]');\n            _context25.t0 = icon;\n\n            if (!_context25.t0) {\n              _context25.next = 8;\n              break;\n            }\n\n            _context25.next = 7;\n            return imgExists(icon.href);\n\n          case 7:\n            _context25.t0 = _context25.sent;\n\n          case 8:\n            if (!_context25.t0) {\n              _context25.next = 10;\n              break;\n            }\n\n            return _context25.abrupt(\"return\", icon.href);\n\n          case 10:\n            // Search through available icons in no particular order\n            icon = Array.from(_document.querySelectorAll('head > link[rel=\"icon\"]')).find(function (_icon) {\n              return Boolean(_icon.href);\n            });\n            _context25.t1 = icon;\n\n            if (!_context25.t1) {\n              _context25.next = 16;\n              break;\n            }\n\n            _context25.next = 15;\n            return imgExists(icon.href);\n\n          case 15:\n            _context25.t1 = _context25.sent;\n\n          case 16:\n            if (!_context25.t1) {\n              _context25.next = 18;\n              break;\n            }\n\n            return _context25.abrupt(\"return\", icon.href);\n\n          case 18:\n            return _context25.abrupt(\"return\", \"\");\n\n          case 21:\n            _context25.prev = 21;\n            _context25.t2 = _context25[\"catch\"](0);\n            return _context25.abrupt(\"return\", \"\");\n\n          case 24:\n          case \"end\":\n            return _context25.stop();\n        }\n      }\n    }, _callee25, null, [[0, 21]]);\n  }));\n  return _getSiteIcon.apply(this, arguments);\n}\n\nvar getSiteMetadata = /*#__PURE__*/function () {\n  var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n    return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            _context6.t0 = getSiteName(window);\n            _context6.next = 3;\n            return getSiteIcon(window);\n\n          case 3:\n            _context6.t1 = _context6.sent;\n            return _context6.abrupt(\"return\", {\n              name: _context6.t0,\n              icon: _context6.t1\n            });\n\n          case 5:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, _callee6);\n  }));\n\n  return function getSiteMetadata() {\n    return _ref7.apply(this, arguments);\n  };\n}();\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n\nvar PROVIDER_UNSAFE_METHODS = [\"send_transaction\", \"sign_transaction\", \"sign_all_transactions\", \"sign_message\", \"connect\"];\nvar COMMUNICATION_UNSAFE_METHODS = [COMMUNICATION_JRPC_METHODS.SET_PROVIDER];\nvar isLocalStorageAvailable = storageAvailable(\"localStorage\"); // preload for iframe doesn't work https://bugs.chromium.org/p/chromium/issues/detail?id=593267\n\n(function () {\n  var _preLoadIframe = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7() {\n    var torusIframeHtml, _yield$getTorusUrl, torusUrl;\n\n    return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n      while (1) {\n        switch (_context7.prev = _context7.next) {\n          case 0:\n            _context7.prev = 0;\n\n            if (!(typeof document === \"undefined\")) {\n              _context7.next = 3;\n              break;\n            }\n\n            return _context7.abrupt(\"return\");\n\n          case 3:\n            torusIframeHtml = document.createElement(\"link\");\n            _context7.next = 6;\n            return getTorusUrl(\"production\");\n\n          case 6:\n            _yield$getTorusUrl = _context7.sent;\n            torusUrl = _yield$getTorusUrl.torusUrl;\n            torusIframeHtml.href = \"\".concat(torusUrl, \"/frame\");\n            torusIframeHtml.crossOrigin = \"anonymous\";\n            torusIframeHtml.type = \"text/html\";\n            torusIframeHtml.rel = \"prefetch\";\n\n            if (torusIframeHtml.relList && torusIframeHtml.relList.supports) {\n              if (torusIframeHtml.relList.supports(\"prefetch\")) {\n                document.head.appendChild(torusIframeHtml);\n              }\n            }\n\n            _context7.next = 18;\n            break;\n\n          case 15:\n            _context7.prev = 15;\n            _context7.t0 = _context7[\"catch\"](0);\n            log.warn(_context7.t0);\n\n          case 18:\n          case \"end\":\n            return _context7.stop();\n        }\n      }\n    }, _callee7, null, [[0, 15]]);\n  }));\n\n  function preLoadIframe() {\n    return _preLoadIframe.apply(this, arguments);\n  }\n\n  return preLoadIframe;\n})()();\n\nvar Torus = /*#__PURE__*/function () {\n  function Torus() {\n    _classCallCheck(this, Torus);\n\n    var _ref8 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        _ref8$modalZIndex = _ref8.modalZIndex,\n        modalZIndex = _ref8$modalZIndex === void 0 ? 99999 : _ref8$modalZIndex;\n\n    _defineProperty(this, \"isInitialized\", void 0);\n\n    _defineProperty(this, \"torusAlert\", void 0);\n\n    _defineProperty(this, \"modalZIndex\", void 0);\n\n    _defineProperty(this, \"alertZIndex\", void 0);\n\n    _defineProperty(this, \"requestedLoginProvider\", void 0);\n\n    _defineProperty(this, \"provider\", void 0);\n\n    _defineProperty(this, \"communicationProvider\", void 0);\n\n    _defineProperty(this, \"dappStorageKey\", void 0);\n\n    _defineProperty(this, \"torusAlertContainer\", void 0);\n\n    _defineProperty(this, \"torusUrl\", void 0);\n\n    _defineProperty(this, \"torusIframe\", void 0);\n\n    _defineProperty(this, \"styleLink\", void 0);\n\n    this.torusUrl = \"\";\n    this.isInitialized = false; // init done\n\n    this.requestedLoginProvider = null;\n    this.modalZIndex = modalZIndex;\n    this.alertZIndex = modalZIndex + 1000;\n    this.dappStorageKey = \"\";\n  }\n\n  _createClass(Torus, [{\n    key: \"isLoggedIn\",\n    get: function get() {\n      if (!this.communicationProvider) return false;\n      return this.communicationProvider.isLoggedIn;\n    }\n  }, {\n    key: \"init\",\n    value: function () {\n      var _init = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee10() {\n        var _this12 = this;\n\n        var _ref9,\n            _ref9$buildEnv,\n            buildEnv,\n            _ref9$enableLogging,\n            enableLogging,\n            network,\n            _ref9$showTorusButton,\n            showTorusButton,\n            _ref9$useLocalStorage,\n            useLocalStorage,\n            _ref9$buttonPosition,\n            buttonPosition,\n            _ref9$apiKey,\n            apiKey,\n            _ref9$extraParams,\n            extraParams,\n            _yield$getTorusUrl2,\n            torusUrl,\n            logLevel,\n            dappStorageKey,\n            torusIframeUrl,\n            hashParams,\n            handleSetup,\n            _args10 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                _ref9 = _args10.length > 0 && _args10[0] !== undefined ? _args10[0] : {}, _ref9$buildEnv = _ref9.buildEnv, buildEnv = _ref9$buildEnv === void 0 ? TORUS_BUILD_ENV.PRODUCTION : _ref9$buildEnv, _ref9$enableLogging = _ref9.enableLogging, enableLogging = _ref9$enableLogging === void 0 ? false : _ref9$enableLogging, network = _ref9.network, _ref9$showTorusButton = _ref9.showTorusButton, showTorusButton = _ref9$showTorusButton === void 0 ? false : _ref9$showTorusButton, _ref9$useLocalStorage = _ref9.useLocalStorage, useLocalStorage = _ref9$useLocalStorage === void 0 ? false : _ref9$useLocalStorage, _ref9$buttonPosition = _ref9.buttonPosition, buttonPosition = _ref9$buttonPosition === void 0 ? BUTTON_POSITION.BOTTOM_LEFT : _ref9$buttonPosition, _ref9$apiKey = _ref9.apiKey, apiKey = _ref9$apiKey === void 0 ? \"torus-default\" : _ref9$apiKey, _ref9$extraParams = _ref9.extraParams, extraParams = _ref9$extraParams === void 0 ? {} : _ref9$extraParams;\n\n                if (!this.isInitialized) {\n                  _context10.next = 3;\n                  break;\n                }\n\n                throw new Error(\"Already initialized\");\n\n              case 3:\n                setAPIKey(apiKey);\n                _context10.next = 6;\n                return getTorusUrl(buildEnv);\n\n              case 6:\n                _yield$getTorusUrl2 = _context10.sent;\n                torusUrl = _yield$getTorusUrl2.torusUrl;\n                logLevel = _yield$getTorusUrl2.logLevel;\n                log.info(torusUrl, \"url loaded\");\n                this.torusUrl = torusUrl;\n                log.setDefaultLevel(logLevel);\n                if (enableLogging) log.enableAll();else log.disableAll();\n                dappStorageKey = this.handleDappStorageKey(useLocalStorage);\n                torusIframeUrl = new URL(torusUrl);\n                if (torusIframeUrl.pathname.endsWith(\"/\")) torusIframeUrl.pathname += \"frame\";else torusIframeUrl.pathname += \"/frame\";\n                hashParams = new URLSearchParams();\n                if (dappStorageKey) hashParams.append(\"dappStorageKey\", dappStorageKey);\n                hashParams.append(\"origin\", window.location.origin);\n                torusIframeUrl.hash = hashParams.toString(); // Iframe code\n\n                this.torusIframe = htmlToElement(\"<iframe\\n        id=\\\"torusIframe\\\"\\n        class=\\\"torusIframe\\\"\\n        src=\\\"\".concat(torusIframeUrl.href, \"\\\"\\n        style=\\\"display: none; position: fixed; top: 0; right: 0; width: 100%;\\n        height: 100%; border: none; border-radius: 0; z-index: \").concat(this.modalZIndex.toString(), \"\\\"\\n      ></iframe>\"));\n                this.torusAlertContainer = htmlToElement(\"<div id=\\\"torusAlertContainer\\\" style=\\\"display:none; z-index: \".concat(this.alertZIndex.toString(), \"\\\"></div>\"));\n                this.styleLink = htmlToElement(\"<link href=\\\"\".concat(torusUrl, \"/css/widget.css\\\" rel=\\\"stylesheet\\\" type=\\\"text/css\\\">\"));\n\n                handleSetup = /*#__PURE__*/function () {\n                  var _ref10 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9() {\n                    return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n                      while (1) {\n                        switch (_context9.prev = _context9.next) {\n                          case 0:\n                            return _context9.abrupt(\"return\", new Promise(function (resolve, reject) {\n                              try {\n                                window.document.head.appendChild(_this12.styleLink);\n                                window.document.body.appendChild(_this12.torusIframe);\n                                window.document.body.appendChild(_this12.torusAlertContainer);\n\n                                _this12.torusIframe.addEventListener(\"load\", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8() {\n                                  var dappMetadata;\n                                  return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n                                    while (1) {\n                                      switch (_context8.prev = _context8.next) {\n                                        case 0:\n                                          _context8.next = 2;\n                                          return getSiteMetadata();\n\n                                        case 2:\n                                          dappMetadata = _context8.sent;\n\n                                          // send init params here\n                                          _this12.torusIframe.contentWindow.postMessage({\n                                            buttonPosition: buttonPosition,\n                                            apiKey: apiKey,\n                                            network: typeof network === \"string\" ? getNetworkConfig(network) : network,\n                                            dappMetadata: dappMetadata,\n                                            extraParams: extraParams\n                                          }, torusIframeUrl.origin);\n\n                                          _context8.next = 6;\n                                          return _this12._setupWeb3({\n                                            torusUrl: torusUrl\n                                          });\n\n                                        case 6:\n                                          if (showTorusButton) _this12.showTorusButton();else _this12.hideTorusButton();\n                                          _this12.isInitialized = true;\n                                          window.torus = _this12;\n                                          resolve();\n\n                                        case 10:\n                                        case \"end\":\n                                          return _context8.stop();\n                                      }\n                                    }\n                                  }, _callee8);\n                                })));\n                              } catch (error) {\n                                reject(error);\n                              }\n                            }));\n\n                          case 1:\n                          case \"end\":\n                            return _context9.stop();\n                        }\n                      }\n                    }, _callee9);\n                  }));\n\n                  return function handleSetup() {\n                    return _ref10.apply(this, arguments);\n                  };\n                }();\n\n                _context10.next = 26;\n                return documentReady();\n\n              case 26:\n                _context10.next = 28;\n                return handleSetup();\n\n              case 28:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10, this);\n      }));\n\n      function init() {\n        return _init.apply(this, arguments);\n      }\n\n      return init;\n    }()\n  }, {\n    key: \"login\",\n    value: function () {\n      var _login = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee11() {\n        var _this13 = this;\n\n        var params,\n            res,\n            _args11 = arguments;\n        return _regeneratorRuntime.wrap(function _callee11$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                params = _args11.length > 0 && _args11[0] !== undefined ? _args11[0] : {};\n\n                if (this.isInitialized) {\n                  _context11.next = 3;\n                  break;\n                }\n\n                throw new Error(\"Call init() first\");\n\n              case 3:\n                _context11.prev = 3;\n                this.requestedLoginProvider = params.loginProvider || null;\n\n                if (!this.requestedLoginProvider) {\n                  this.communicationProvider._displayIframe({\n                    isFull: true\n                  });\n                } // If user is already logged in, we assume they have given access to the website\n\n\n                _context11.next = 8;\n                return new Promise(function (resolve, reject) {\n                  // We use this method because we want to update inPage provider state with account info\n                  _this13.provider._rpcRequest({\n                    method: \"solana_requestAccounts\",\n                    params: [_this13.requestedLoginProvider, params.login_hint]\n                  }, getRpcPromiseCallback(resolve, reject));\n                });\n\n              case 8:\n                res = _context11.sent;\n\n                if (!(Array.isArray(res) && res.length > 0)) {\n                  _context11.next = 11;\n                  break;\n                }\n\n                return _context11.abrupt(\"return\", res);\n\n              case 11:\n                throw new Error(\"Login failed\");\n\n              case 14:\n                _context11.prev = 14;\n                _context11.t0 = _context11[\"catch\"](3);\n                log.error(\"login failed\", _context11.t0);\n                throw _context11.t0;\n\n              case 18:\n                _context11.prev = 18;\n                if (this.communicationProvider.isIFrameFullScreen) this.communicationProvider._displayIframe();\n                return _context11.finish(18);\n\n              case 21:\n              case \"end\":\n                return _context11.stop();\n            }\n          }\n        }, _callee11, this, [[3, 14, 18, 21]]);\n      }));\n\n      function login() {\n        return _login.apply(this, arguments);\n      }\n\n      return login;\n    }()\n  }, {\n    key: \"logout\",\n    value: function () {\n      var _logout = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee12() {\n        return _regeneratorRuntime.wrap(function _callee12$(_context12) {\n          while (1) {\n            switch (_context12.prev = _context12.next) {\n              case 0:\n                if (this.communicationProvider.isLoggedIn) {\n                  _context12.next = 2;\n                  break;\n                }\n\n                throw new Error(\"Not logged in\");\n\n              case 2:\n                _context12.next = 4;\n                return this.communicationProvider.request({\n                  method: COMMUNICATION_JRPC_METHODS.LOGOUT,\n                  params: []\n                });\n\n              case 4:\n                this.requestedLoginProvider = null;\n\n              case 5:\n              case \"end\":\n                return _context12.stop();\n            }\n          }\n        }, _callee12, this);\n      }));\n\n      function logout() {\n        return _logout.apply(this, arguments);\n      }\n\n      return logout;\n    }()\n  }, {\n    key: \"cleanUp\",\n    value: function () {\n      var _cleanUp = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee13() {\n        return _regeneratorRuntime.wrap(function _callee13$(_context13) {\n          while (1) {\n            switch (_context13.prev = _context13.next) {\n              case 0:\n                if (!this.communicationProvider.isLoggedIn) {\n                  _context13.next = 3;\n                  break;\n                }\n\n                _context13.next = 3;\n                return this.logout();\n\n              case 3:\n                this.clearInit();\n\n              case 4:\n              case \"end\":\n                return _context13.stop();\n            }\n          }\n        }, _callee13, this);\n      }));\n\n      function cleanUp() {\n        return _cleanUp.apply(this, arguments);\n      }\n\n      return cleanUp;\n    }()\n  }, {\n    key: \"clearInit\",\n    value: function clearInit() {\n      function isElement(element) {\n        return element instanceof Element || element instanceof Document;\n      }\n\n      if (isElement(this.styleLink) && window.document.body.contains(this.styleLink)) {\n        this.styleLink.remove();\n        this.styleLink = undefined;\n      }\n\n      if (isElement(this.torusIframe) && window.document.body.contains(this.torusIframe)) {\n        this.torusIframe.remove();\n        this.torusIframe = undefined;\n      }\n\n      if (isElement(this.torusAlertContainer) && window.document.body.contains(this.torusAlertContainer)) {\n        this.torusAlert = undefined;\n        this.torusAlertContainer.remove();\n        this.torusAlertContainer = undefined;\n      }\n\n      this.isInitialized = false;\n    }\n  }, {\n    key: \"hideTorusButton\",\n    value: function hideTorusButton() {\n      this.communicationProvider.hideTorusButton();\n    }\n  }, {\n    key: \"showTorusButton\",\n    value: function showTorusButton() {\n      this.communicationProvider.showTorusButton();\n    }\n  }, {\n    key: \"setProvider\",\n    value: function () {\n      var _setProvider = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee14(params) {\n        return _regeneratorRuntime.wrap(function _callee14$(_context14) {\n          while (1) {\n            switch (_context14.prev = _context14.next) {\n              case 0:\n                _context14.next = 2;\n                return this.communicationProvider.request({\n                  method: COMMUNICATION_JRPC_METHODS.SET_PROVIDER,\n                  params: _objectSpread({}, params)\n                });\n\n              case 2:\n              case \"end\":\n                return _context14.stop();\n            }\n          }\n        }, _callee14, this);\n      }));\n\n      function setProvider(_x7) {\n        return _setProvider.apply(this, arguments);\n      }\n\n      return setProvider;\n    }()\n  }, {\n    key: \"showWallet\",\n    value: function () {\n      var _showWallet = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee15(path) {\n        var params,\n            instanceId,\n            finalPath,\n            finalUrl,\n            walletWindow,\n            _args15 = arguments;\n        return _regeneratorRuntime.wrap(function _callee15$(_context15) {\n          while (1) {\n            switch (_context15.prev = _context15.next) {\n              case 0:\n                params = _args15.length > 1 && _args15[1] !== undefined ? _args15[1] : {};\n                _context15.next = 3;\n                return this.communicationProvider.request({\n                  method: COMMUNICATION_JRPC_METHODS.WALLET_INSTANCE_ID,\n                  params: []\n                });\n\n              case 3:\n                instanceId = _context15.sent;\n                finalPath = path ? \"/\".concat(path) : \"\";\n                finalUrl = new URL(\"\".concat(this.torusUrl, \"/wallet\").concat(finalPath)); // Using URL constructor to prevent js injection and allow parameter validation.!\n\n                finalUrl.searchParams.append(\"instanceId\", instanceId);\n                Object.keys(params).forEach(function (x) {\n                  finalUrl.searchParams.append(x, params[x]);\n                });\n\n                if (this.dappStorageKey) {\n                  finalUrl.hash = \"#dappStorageKey=\".concat(this.dappStorageKey);\n                } // No need to track this window state. Hence, no _handleWindow call.\n\n\n                walletWindow = new PopupHandler({\n                  url: finalUrl,\n                  features: getPopupFeatures(FEATURES_DEFAULT_WALLET_WINDOW)\n                });\n                walletWindow.open();\n\n              case 11:\n              case \"end\":\n                return _context15.stop();\n            }\n          }\n        }, _callee15, this);\n      }));\n\n      function showWallet(_x8) {\n        return _showWallet.apply(this, arguments);\n      }\n\n      return showWallet;\n    }()\n  }, {\n    key: \"getUserInfo\",\n    value: function () {\n      var _getUserInfo = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee16() {\n        var userInfoResponse;\n        return _regeneratorRuntime.wrap(function _callee16$(_context16) {\n          while (1) {\n            switch (_context16.prev = _context16.next) {\n              case 0:\n                _context16.next = 2;\n                return this.communicationProvider.request({\n                  method: COMMUNICATION_JRPC_METHODS.USER_INFO,\n                  params: []\n                });\n\n              case 2:\n                userInfoResponse = _context16.sent;\n                return _context16.abrupt(\"return\", userInfoResponse);\n\n              case 4:\n              case \"end\":\n                return _context16.stop();\n            }\n          }\n        }, _callee16, this);\n      }));\n\n      function getUserInfo() {\n        return _getUserInfo.apply(this, arguments);\n      }\n\n      return getUserInfo;\n    }()\n  }, {\n    key: \"initiateTopup\",\n    value: function () {\n      var _initiateTopup = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee17(provider, params) {\n        var windowId, topupResponse;\n        return _regeneratorRuntime.wrap(function _callee17$(_context17) {\n          while (1) {\n            switch (_context17.prev = _context17.next) {\n              case 0:\n                if (this.isInitialized) {\n                  _context17.next = 2;\n                  break;\n                }\n\n                throw new Error(\"Torus is not initialized\");\n\n              case 2:\n                windowId = getWindowId();\n\n                this.communicationProvider._handleWindow(windowId);\n\n                _context17.next = 6;\n                return this.communicationProvider.request({\n                  method: COMMUNICATION_JRPC_METHODS.TOPUP,\n                  params: {\n                    provider: provider,\n                    params: params,\n                    windowId: windowId\n                  }\n                });\n\n              case 6:\n                topupResponse = _context17.sent;\n                return _context17.abrupt(\"return\", topupResponse);\n\n              case 8:\n              case \"end\":\n                return _context17.stop();\n            }\n          }\n        }, _callee17, this);\n      }));\n\n      function initiateTopup(_x9, _x10) {\n        return _initiateTopup.apply(this, arguments);\n      }\n\n      return initiateTopup;\n    }() // Solana specific API\n\n  }, {\n    key: \"sendTransaction\",\n    value: function () {\n      var _sendTransaction = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee18(transaction) {\n        var response;\n        return _regeneratorRuntime.wrap(function _callee18$(_context18) {\n          while (1) {\n            switch (_context18.prev = _context18.next) {\n              case 0:\n                _context18.next = 2;\n                return this.provider.request({\n                  method: \"send_transaction\",\n                  // params: { message: transaction.serializeMessage().toString(\"hex\") },\n                  params: {\n                    message: transaction.serialize({\n                      requireAllSignatures: false\n                    }).toString(\"hex\")\n                  }\n                });\n\n              case 2:\n                response = _context18.sent;\n                return _context18.abrupt(\"return\", response);\n\n              case 4:\n              case \"end\":\n                return _context18.stop();\n            }\n          }\n        }, _callee18, this);\n      }));\n\n      function sendTransaction(_x11) {\n        return _sendTransaction.apply(this, arguments);\n      }\n\n      return sendTransaction;\n    }()\n  }, {\n    key: \"signTransaction\",\n    value: function () {\n      var _signTransaction = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee19(transaction) {\n        var response, buf, sendTx;\n        return _regeneratorRuntime.wrap(function _callee19$(_context19) {\n          while (1) {\n            switch (_context19.prev = _context19.next) {\n              case 0:\n                _context19.next = 2;\n                return this.provider.request({\n                  method: \"sign_transaction\",\n                  // params: { message: transaction.serializeMessage().toString(\"hex\") },\n                  params: {\n                    message: transaction.serialize({\n                      requireAllSignatures: false\n                    }).toString(\"hex\")\n                  }\n                });\n\n              case 2:\n                response = _context19.sent;\n                buf = Buffer.from(response, \"hex\");\n                sendTx = Transaction.from(buf);\n                return _context19.abrupt(\"return\", sendTx);\n\n              case 6:\n              case \"end\":\n                return _context19.stop();\n            }\n          }\n        }, _callee19, this);\n      }));\n\n      function signTransaction(_x12) {\n        return _signTransaction.apply(this, arguments);\n      }\n\n      return signTransaction;\n    }()\n  }, {\n    key: \"signAllTransactions\",\n    value: function () {\n      var _signAllTransactions = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee20(transactions) {\n        var encodedTransactions, response, allSignedTransaction;\n        return _regeneratorRuntime.wrap(function _callee20$(_context20) {\n          while (1) {\n            switch (_context20.prev = _context20.next) {\n              case 0:\n                encodedTransactions = transactions.map(function (x) {\n                  return x.serialize({\n                    requireAllSignatures: false\n                  }).toString(\"hex\");\n                });\n                _context20.next = 3;\n                return this.provider.request({\n                  method: \"sign_all_transactions\",\n                  params: {\n                    message: encodedTransactions\n                  }\n                });\n\n              case 3:\n                response = _context20.sent;\n                allSignedTransaction = response.map(function (msg) {\n                  return Transaction.from(Buffer.from(msg, \"hex\"));\n                });\n                return _context20.abrupt(\"return\", allSignedTransaction);\n\n              case 6:\n              case \"end\":\n                return _context20.stop();\n            }\n          }\n        }, _callee20, this);\n      }));\n\n      function signAllTransactions(_x13) {\n        return _signAllTransactions.apply(this, arguments);\n      }\n\n      return signAllTransactions;\n    }()\n  }, {\n    key: \"signMessage\",\n    value: function () {\n      var _signMessage = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee21(data) {\n        var response;\n        return _regeneratorRuntime.wrap(function _callee21$(_context21) {\n          while (1) {\n            switch (_context21.prev = _context21.next) {\n              case 0:\n                _context21.next = 2;\n                return this.provider.request({\n                  method: \"sign_message\",\n                  params: {\n                    data: data\n                  }\n                });\n\n              case 2:\n                response = _context21.sent;\n                return _context21.abrupt(\"return\", response);\n\n              case 4:\n              case \"end\":\n                return _context21.stop();\n            }\n          }\n        }, _callee21, this);\n      }));\n\n      function signMessage(_x14) {\n        return _signMessage.apply(this, arguments);\n      }\n\n      return signMessage;\n    }()\n  }, {\n    key: \"getGaslessPublicKey\",\n    value: function () {\n      var _getGaslessPublicKey = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee22() {\n        var response;\n        return _regeneratorRuntime.wrap(function _callee22$(_context22) {\n          while (1) {\n            switch (_context22.prev = _context22.next) {\n              case 0:\n                _context22.next = 2;\n                return this.provider.request({\n                  method: \"get_gasless_public_key\",\n                  params: []\n                });\n\n              case 2:\n                response = _context22.sent;\n                return _context22.abrupt(\"return\", response);\n\n              case 4:\n              case \"end\":\n                return _context22.stop();\n            }\n          }\n        }, _callee22, this);\n      }));\n\n      function getGaslessPublicKey() {\n        return _getGaslessPublicKey.apply(this, arguments);\n      }\n\n      return getGaslessPublicKey;\n    }() // async connect(): Promise<boolean> {\n    //   const response = (await this.provider.request({\n    //     method: \"connect\",\n    //     params: {},\n    //   })) as boolean;\n    //   return response;\n    // }\n\n  }, {\n    key: \"handleDappStorageKey\",\n    value: function handleDappStorageKey(useLocalStorage) {\n      var dappStorageKey = \"\";\n\n      if (isLocalStorageAvailable && useLocalStorage) {\n        var storedKey = window.localStorage.getItem(configuration.localStorageKey);\n        if (storedKey) dappStorageKey = storedKey;else {\n          var generatedKey = \"torus-app-\".concat(getWindowId());\n          window.localStorage.setItem(configuration.localStorageKey, generatedKey);\n          dappStorageKey = generatedKey;\n        }\n      }\n\n      this.dappStorageKey = dappStorageKey;\n      return dappStorageKey;\n    }\n  }, {\n    key: \"_setupWeb3\",\n    value: function () {\n      var _setupWeb = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee23(providerParams) {\n        var _this14 = this;\n\n        var providerStream, communicationStream, inPageProvider, communicationProvider, detectAccountRequestPrototypeModifier, proxiedInPageProvider, proxiedCommunicationProvider;\n        return _regeneratorRuntime.wrap(function _callee23$(_context23) {\n          while (1) {\n            switch (_context23.prev = _context23.next) {\n              case 0:\n                log.info(\"setupWeb3 running\"); // setup background connection\n\n                providerStream = new BasePostMessageStream({\n                  name: \"embed_torus\",\n                  target: \"iframe_torus\",\n                  targetWindow: this.torusIframe.contentWindow\n                }); // We create another LocalMessageDuplexStream for communication between dapp <> iframe\n\n                communicationStream = new BasePostMessageStream({\n                  name: \"embed_communication\",\n                  target: \"iframe_communication\",\n                  targetWindow: this.torusIframe.contentWindow\n                }); // compose the inPage provider\n\n                inPageProvider = new TorusInPageProvider(providerStream, {});\n                communicationProvider = new TorusCommunicationProvider(communicationStream, {});\n\n                inPageProvider.tryWindowHandle = function (payload, cb) {\n                  var _payload = payload;\n\n                  if (!Array.isArray(_payload) && PROVIDER_UNSAFE_METHODS.includes(_payload.method)) {\n                    if (!_this14.communicationProvider.isLoggedIn) throw new Error(\"User Not Logged In\");\n                    var windowId = getWindowId();\n\n                    communicationProvider._handleWindow(windowId, {\n                      target: \"_blank\",\n                      features: getPopupFeatures(FEATURES_CONFIRM_WINDOW)\n                    }); // for inPageProvider methods sending windowId in request instead of params\n                    // as params might be positional.\n\n\n                    _payload.windowId = windowId;\n                  }\n\n                  inPageProvider._rpcEngine.handle(_payload, cb);\n                };\n\n                communicationProvider.tryWindowHandle = function (payload, cb) {\n                  var _payload = payload;\n\n                  if (!Array.isArray(_payload) && COMMUNICATION_UNSAFE_METHODS.includes(_payload.method)) {\n                    var windowId = getWindowId();\n\n                    communicationProvider._handleWindow(windowId, {\n                      target: \"_blank\",\n                      features: getPopupFeatures(FEATURES_PROVIDER_CHANGE_WINDOW) // todo: are these features generic for all\n\n                    }); // for communication methods sending window id in jrpc req params\n\n\n                    _payload.params.windowId = windowId;\n                  }\n\n                  communicationProvider._rpcEngine.handle(_payload, cb);\n                }; // detect solana_requestAccounts and pipe to enable for now\n\n\n                detectAccountRequestPrototypeModifier = function detectAccountRequestPrototypeModifier(m) {\n                  var originalMethod = inPageProvider[m]; // eslint-disable-next-line @typescript-eslint/no-this-alias\n\n                  var self = _this14;\n\n                  inPageProvider[m] = function providerFunc(request, cb) {\n                    var method = request.method,\n                        _request$params = request.params,\n                        params = _request$params === void 0 ? [] : _request$params;\n\n                    if (method === \"solana_requestAccounts\") {\n                      if (!cb) return self.login({\n                        loginProvider: params[0]\n                      });\n                      self.login({\n                        loginProvider: params[0]\n                      }) // eslint-disable-next-line promise/no-callback-in-promise\n                      .then(function (res) {\n                        return cb(null, res);\n                      }) // eslint-disable-next-line promise/no-callback-in-promise\n                      .catch(function (err) {\n                        return cb(err);\n                      });\n                    }\n\n                    return originalMethod.apply(this, [request, cb]);\n                  };\n                }; // Detects call to solana_requestAccounts in request & sendAsync and passes to login\n\n\n                detectAccountRequestPrototypeModifier(\"request\");\n                detectAccountRequestPrototypeModifier(\"sendAsync\");\n                detectAccountRequestPrototypeModifier(\"send\");\n                proxiedInPageProvider = new Proxy(inPageProvider, {\n                  // straight up lie that we deleted the property so that it doesn't\n                  // throw an error in strict mode\n                  deleteProperty: function deleteProperty() {\n                    return true;\n                  }\n                });\n                proxiedCommunicationProvider = new Proxy(communicationProvider, {\n                  // straight up lie that we deleted the property so that it doesn't\n                  // throw an error in strict mode\n                  deleteProperty: function deleteProperty() {\n                    return true;\n                  }\n                });\n                this.provider = proxiedInPageProvider;\n                this.communicationProvider = proxiedCommunicationProvider;\n                _context23.next = 17;\n                return Promise.all([inPageProvider._initializeState(), communicationProvider._initializeState(_objectSpread(_objectSpread({}, providerParams), {}, {\n                  dappStorageKey: this.dappStorageKey,\n                  torusAlertContainer: this.torusAlertContainer,\n                  torusIframe: this.torusIframe\n                }))]);\n\n              case 17:\n                log.debug(\"Torus - injected provider\");\n\n              case 18:\n              case \"end\":\n                return _context23.stop();\n            }\n          }\n        }, _callee23, this);\n      }));\n\n      function _setupWeb3(_x15) {\n        return _setupWeb.apply(this, arguments);\n      }\n\n      return _setupWeb3;\n    }()\n  }]);\n\n  return Torus;\n}();\n\nexport { BUTTON_POSITION, LOGIN_PROVIDER, PAYMENT_PROVIDER, TORUS_BUILD_ENV, TorusInPageProvider, Torus as default };","map":{"version":3,"mappings":"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","names":["errors","disconnected","permanentlyDisconnected","unsupportedSync","method","invalidDuplexStream","invalidOptions","maxEventListeners","invalidRequestArgs","invalidRequestMethod","invalidRequestParams","invalidLoggerObject","invalidLoggerMethod","info","connected","chainId","warnings","PAYMENT_PROVIDER","MOONPAY","WYRE","RAMPNETWORK","XANPOOL","MERCURYO","TRANSAK","TORUS_BUILD_ENV","PRODUCTION","DEVELOPMENT","TESTING","BUTTON_POSITION","BOTTOM_LEFT","TOP_LEFT","BOTTOM_RIGHT","TOP_RIGHT","LOGIN_PROVIDER","GOOGLE","FACEBOOK","REDDIT","DISCORD","TWITCH","APPLE","LINE","GITHUB","KAKAO","LINKEDIN","TWITTER","WEIBO","WECHAT","EMAIL_PASSWORDLESS","translations","en","embed","continue","actionRequired","pendingAction","cookiesRequired","enableCookies","clickHere","de","ja","ko","zh","supportedVerifierList","api","prodTorusUrl","localStorageKey","window","location","hostname","loglevel","getLogger","createErrorMiddleware","req","res","next","error","ethErrors","rpc","invalidRequest","message","data","done","log","logStreamDisconnectWarning","remoteLabel","emitter","warningMsg","stack","warn","listenerCount","emit","getWindowId","Math","random","toString","slice","getTorusUrl","buildEnv","torusUrl","logLevel","getUserLanguage","userLanguage","navigator","language","userLanguages","split","Object","prototype","hasOwnProperty","call","config","FEATURES_PROVIDER_CHANGE_WINDOW","height","width","FEATURES_DEFAULT_WALLET_WINDOW","FEATURES_DEFAULT_POPUP_WINDOW","FEATURES_CONFIRM_WINDOW","storageAvailable","type","storage","x","setItem","removeItem","e","code","name","length","getPopupFeatures","w","_ref","h","dualScreenLeft","screenLeft","undefined","screenX","dualScreenTop","screenTop","screenY","innerWidth","document","documentElement","clientWidth","screen","innerHeight","clientHeight","systemZoom","left","abs","top","features","getNetworkConfig","label","blockExplorerUrl","displayName","logo","rpcTarget","ticker","tickerName","BaseProvider","constructor","connectionStream","jsonRpcStreamName","isDuplexStream","Error","messages","isTorus","setMaxListeners","_handleConnect","bind","_handleDisconnect","_handleStreamDisconnect","_rpcRequest","_initializeState","request","sendAsync","mux","ObjectMultiplex","pump","ignoreStream","jsonRpcConnection","createStreamMiddleware","stream","createStream","rpcEngine","JRPCEngine","push","createIdRemapMiddleware","createLoggerMiddleware","origin","middleware","_rpcEngine","jsonRpcConnectionEvents","events","args","Array","isArray","params","Promise","resolve","reject","getRpcPromiseCallback","send","payload","callback","streamName","SafeEventEmitter","handleEvent","handle","eventName","handler","handlerArgs","handlerWrapper","removeEventListener","addEventListener","documentReady","readyState","htmlToElement","html","template","createElement","trimmedHtml","trim","innerHTML","content","firstChild","PopupHandler","url","target","windowTimer","iClosedWindow","_setupTimer","Number","setInterval","closed","clearInterval","open","href","_this$window","focus","close","redirect","locationReplaceOnRedirect","replace","TorusCommunicationProvider","_state","_defaultState","dappStorageKey","languageTranslations","configuration","embedTranslations","windowRefs","on","isConnected","notificationHandler","COMMUNICATION_NOTIFICATIONS","IFRAME_STATUS","isFullScreen","rid","_displayIframe","isFull","CREATE_WINDOW","windowId","_createPopupBlockAlert","CLOSE_WINDOW","_handleCloseWindow","USER_LOGGED_IN","currentLoginProvider","isLoggedIn","USER_LOGGED_OUT","isIFrameFullScreen","torusAlertContainer","torusIframe","COMMUNICATION_JRPC_METHODS","GET_PROVIDER_STATE","initialized","_handleWindow","arguments","finalUrl","URL","hash","handledWindow","OPENED_WINDOW","once","CLOSED_WINDOW","style","display","torusWidgetVisibility","buttonPosition","right","bottom","assign","hideTorusButton","showTorusButton","cb","_payload","jsonrpc","tryWindowHandle","debug","isRecoverable","errorMessage","isPermanentlyDisconnected","EthereumRpcError","logoUrl","getLogoUrl","torusAlert","successAlert","btnContainer","appendChild","bindOnLoad","remove","children","attachOnLoad","hasEmittedConnection","TorusInPageProvider","selectedAddress","_handleAccountsChanged","_handleChainChanged","_handleUnlockStateChanged","jsonRpcNotificationHandler","PROVIDER_NOTIFICATIONS","ACCOUNTS_CHANGED","UNLOCK_STATE_CHANGED","CHAIN_CHANGED","PROVIDER_JRPC_METHODS","accounts","isUnlocked","isInternal","err","result","isEthAccounts","finalAccounts","account","dequal","imgExists","img","onload","onerror","src","getSiteName","siteName","querySelector","metaTitle","title","getSiteIcon","icon","from","querySelectorAll","find","_icon","Boolean","getSiteMetadata","PROVIDER_UNSAFE_METHODS","COMMUNICATION_UNSAFE_METHODS","SET_PROVIDER","isLocalStorageAvailable","torusIframeHtml","crossOrigin","rel","relList","supports","head","preLoadIframe","Torus","modalZIndex","isInitialized","requestedLoginProvider","alertZIndex","communicationProvider","enableLogging","network","useLocalStorage","apiKey","extraParams","setAPIKey","setDefaultLevel","enableAll","disableAll","handleDappStorageKey","torusIframeUrl","pathname","endsWith","hashParams","URLSearchParams","append","styleLink","handleSetup","body","dappMetadata","contentWindow","postMessage","_setupWeb3","torus","loginProvider","provider","login_hint","LOGOUT","logout","clearInit","isElement","element","Element","Document","contains","path","WALLET_INSTANCE_ID","instanceId","finalPath","searchParams","keys","forEach","walletWindow","USER_INFO","userInfoResponse","TOPUP","topupResponse","transaction","serialize","requireAllSignatures","response","buf","Buffer","sendTx","Transaction","transactions","encodedTransactions","map","allSignedTransaction","msg","storedKey","localStorage","getItem","generatedKey","providerParams","providerStream","BasePostMessageStream","targetWindow","communicationStream","inPageProvider","includes","detectAccountRequestPrototypeModifier","m","originalMethod","self","providerFunc","login","then","catch","apply","proxiedInPageProvider","Proxy","deleteProperty","proxiedCommunicationProvider","all"],"sources":["../src/messages.ts","../src/interfaces.ts","../src/config.ts","../src/loglevel.ts","../src/utils.ts","../src/baseProvider.ts","../src/embedUtils.ts","../src/PopupHandler.ts","../src/communicationProvider.ts","../src/inPageProvider.ts","../src/siteMetadata.ts","../src/embed.ts"],"sourcesContent":[null,null,null,null,null,null,null,null,null,null,null,null]},"metadata":{},"sourceType":"module"}